<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>定时发送微信消息</title>
      <link href="/a8d69ab8d30a/"/>
      <url>/a8d69ab8d30a/</url>
      
        <content type="html"><![CDATA[<p>按Excel模板定时发送微信消息</p><span id="more"></span><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import schedule</span><br><span class="line">import time</span><br><span class="line">from wxauto import *</span><br><span class="line">import pyautogui</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"># 定义打开Excel文件函数</span><br><span class="line">def read_excel(file_path):</span><br><span class="line">    data = pd.read_excel(file_path)</span><br><span class="line">    return data</span><br><span class="line"></span><br><span class="line"># 定义微信发送消息函数</span><br><span class="line">def job(msg,who):</span><br><span class="line">    wx = WeChat()</span><br><span class="line">    wx.SendMsg(msg,who)</span><br><span class="line">    pyautogui.hotkey(&quot;Ctrl&quot;,&quot;Alt&quot;,&quot;z&quot;)</span><br><span class="line"></span><br><span class="line"># 定义定时任务函数</span><br><span class="line">def tasks(data):</span><br><span class="line">    for index,row in data.iterrows():</span><br><span class="line">        send_time = row[&#x27;Time&#x27;]</span><br><span class="line">        who = row[&#x27;Object&#x27;]</span><br><span class="line">        msg = row[&#x27;Task&#x27;]</span><br><span class="line">        schedule.every().day.at(str(send_time)).do(job,msg,who)</span><br><span class="line"></span><br><span class="line"># 查找当前文件夹.xlsx文件</span><br><span class="line">path = os.getcwd()</span><br><span class="line">files = os.listdir(path)</span><br><span class="line">excelfiles = [f for f in files if not f.startswith((&quot;~$&quot;)) and f.endswith((&quot;.xlsx&quot;))]</span><br><span class="line">for file in excelfiles:</span><br><span class="line">    fullpath = os.path.join(path,file)</span><br><span class="line"></span><br><span class="line"># 读取Excel模板数据</span><br><span class="line">excel_data = read_excel(fullpath)</span><br><span class="line"></span><br><span class="line"># 执行定时任务</span><br><span class="line">tasks(excel_data)</span><br><span class="line"></span><br><span class="line"># 持续运行待处理任务</span><br><span class="line">while True:</span><br><span class="line">    schedule.run_pending()</span><br><span class="line">    time.sleep(1)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python常见错误类型</title>
      <link href="/4acb0210aa57/"/>
      <url>/4acb0210aa57/</url>
      
        <content type="html"><![CDATA[<p>1.NameError: name ‘xxx’ is not defined<br>名称错误:名称“xxx”未定义</p><span id="more"></span><p>2.TypeError: unsupported operand type(s) for +: ‘int’ and ‘str’<br>类型错误:不支持+的操作数类型:’int’和’str’</p><p>3.TypeError: ‘str’ object is not callable<br>类型错误:“str”对象不可调用</p><p>4.IndexError: list index out of range<br>索引错误:列表索引超出范围</p><p>5.KeyError: ‘xxx’<br>键错误:’xxx’</p><p>6.ValueError: invalid literal for int() with base 10: ‘xxx’<br>值错误:基数10为“xxx”的int（）字面值无效</p><p>7.ZeroDivisionError: division by zero<br>零除法错误:除数为零</p><p>8.AttributeError: ‘xxx’ object has no attribute ‘yyy’<br>属性错误:“xxx”对象没有属性“yyy”</p><p>9.FileNotFoundError: [Errno 2] No such file or directory: ‘xxx’<br>文件未找到错误:[错误2]没有这样的文件或目录:’xxx’</p><p>10.IndentationError: expected an indented block<br>缩进错误:期望有一个缩进块</p><p>11.SyntaxError: invalid syntax<br>语法错误:语法无效</p><p>12.TypeError: ‘list’ object cannot be interpreted as an integer<br>类型错误:“list”对象不能被解释为整数</p><p>13.TypeError: missing 1 required positional argument: ‘xxx’<br>类型错误:缺少1个必填位置参数:“xxx”</p><p>14.UnboundLocalError: local variable ‘xxx’ referenced before assignment<br>未绑定本地错误:在赋值之前引用了局部变量“xxx”</p><p>15.RecursionError: maximum recursion depth exceeded<br>递归错误:最大递归深度超过</p><p>16.ImportError: No module named ‘xxx’<br>导入错误:没有名为“xxx”的模块</p><p>17.TypeError: can only concatenate str (not “int”) to str<br>类型错误:只能将str（而不是int）连接到str</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>创建库位二维码</title>
      <link href="/d3dee640cf8c/"/>
      <url>/d3dee640cf8c/</url>
      
        <content type="html"><![CDATA[<p>输入库位编码和库位名称创建二维码</p><span id="more"></span><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import qrcode</span><br><span class="line">from PIL import Image, ImageDraw, ImageFont</span><br><span class="line"></span><br><span class="line">qr_text = input(&quot;输入库位编码：&quot;)</span><br><span class="line">qr_name = input(&quot;输入库位名称：&quot;)</span><br><span class="line"> </span><br><span class="line"># 生成二维码</span><br><span class="line">qr = qrcode.QRCode(</span><br><span class="line">    version=1,</span><br><span class="line">    error_correction=qrcode.constants.ERROR_CORRECT_L,</span><br><span class="line">    box_size=30,</span><br><span class="line">    border=4,</span><br><span class="line">)</span><br><span class="line">qr.add_data(qr_text)</span><br><span class="line">qr.make(fit=True)</span><br><span class="line"></span><br><span class="line"># 创建一个图片 </span><br><span class="line">img = qr.make_image(fill=&#x27;black&#x27;, back_color=&#x27;white&#x27;)</span><br><span class="line"></span><br><span class="line"># 创建可以在图片上绘图的对象</span><br><span class="line">draw = ImageDraw.Draw(img)</span><br><span class="line"> </span><br><span class="line"># 加载字体</span><br><span class="line">font = ImageFont.truetype(&quot;arial.ttf&quot;, 80)</span><br><span class="line"></span><br><span class="line"># 计算文本宽度和高度</span><br><span class="line">width,height = draw.textsize(qr_name, font=font)</span><br><span class="line"></span><br><span class="line"># 计算文本在图片的位置</span><br><span class="line">x = (width - img.width) / 2</span><br><span class="line">y = (img.height - height) / 50</span><br><span class="line"></span><br><span class="line"># 绘制文本</span><br><span class="line">draw.text((x, y), qr_name, font=font, fill=&#x27;black&#x27;)</span><br><span class="line"> </span><br><span class="line"># 保存图片</span><br><span class="line">img.save(qr_name + &#x27;.png&#x27;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>批量生成标签模板</title>
      <link href="/b839bbc394c6/"/>
      <url>/b839bbc394c6/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import qrcode</span><br><span class="line">import openpyxl</span><br><span class="line">from openpyxl.drawing.image import Image</span><br><span class="line"></span><br><span class="line"># 制作二维码</span><br><span class="line">def gen_image(text,name):</span><br><span class="line">        img = qrcode.make(text)</span><br><span class="line">        with open(name,&quot;wb&quot;) as f:</span><br><span class="line">            img.save(f)</span><br><span class="line"></span><br><span class="line"># 写入二维码           </span><br><span class="line">def write_img(img_name,position):</span><br><span class="line">imgsize = (720/12,720/12)</span><br><span class="line">img = Image(img_name)</span><br><span class="line">img.width,img.height = imgsize</span><br><span class="line">wb[str(i)].add_image(img,position)</span><br><span class="line"></span><br><span class="line"># 查找excel文件</span><br><span class="line">def excel_file():</span><br><span class="line">        path = os.getcwd()</span><br><span class="line">        files = os.listdir(path)</span><br><span class="line">        fullpath = [f for f in files if not f.startswith((&quot;~$&quot;)) and f.endswith((&quot;.xlsx&quot;))]</span><br><span class="line">        return  os.path.join(path,fullpath[0])</span><br><span class="line">   </span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">        # 打开excel工作薄</span><br><span class="line">        wb = openpyxl.load_workbook(excel_file())</span><br><span class="line">        # 打开excel工作表清单</span><br><span class="line">        QD_sheet = wb.worksheets[0]</span><br><span class="line">        # 打开excel工作表标签模板</span><br><span class="line">        BQ_sheet = wb.worksheets[1]</span><br><span class="line">        </span><br><span class="line">        if not os.path.exists(&quot;qrcode&quot;):</span><br><span class="line">                os.mkdir(&quot;qrcode&quot;)</span><br><span class="line"></span><br><span class="line">        for i in range(1,10):</span><br><span class="line">                # 复制模板工作表</span><br><span class="line">                new_sheet = wb.copy_worksheet(BQ_sheet)</span><br><span class="line">                # 重命名新工作表</span><br><span class="line">                new_sheet.title = str(i)</span><br><span class="line">                # 将清单中的SN复制到新工作表指定单元格</span><br><span class="line">                text = QD_sheet[&#x27;A&#x27; + str(i+1)].value</span><br><span class="line">                new_sheet[&#x27;B7&#x27;].value = text</span><br><span class="line"></span><br><span class="line">                # 指定二维码存放位置</span><br><span class="line">                text_png_name = &quot;qrcode/&quot; + &quot;A&quot; + str(i+1) + &quot;.png&quot;</span><br><span class="line">                # 指定二维码粘贴位置</span><br><span class="line">                paste = &quot;A7&quot;</span><br><span class="line">                # 按清单列表制作二维码并存放到指定位置</span><br><span class="line">                gen_image(text,text_png_name)</span><br><span class="line">                # 将二维码放置到新工作表指定单元格</span><br><span class="line">                write_img(text_png_name,paste)</span><br><span class="line">                                                               </span><br><span class="line">#保存excel文件</span><br><span class="line">        wb.save(excel_file())</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git创建分支</title>
      <link href="/ac0b5876d078/"/>
      <url>/ac0b5876d078/</url>
      
        <content type="html"><![CDATA[<p>1、打开博客目录，目录下有一个“.gitignore”文件，没有就自己创建一个，该文件用于忽略指定的文件不进行同步，配置内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line">db.json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line">public/</span><br><span class="line">.deploy*/</span><br></pre></td></tr></table></figure><p>2、右键打开“git”，依次输入以下命令进行本地仓库与远程仓库对接：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 初始化本地仓库</span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"># 本地仓库和GitHub远程仓库对接</span><br><span class="line"># nineya/blog_source.git修改为博客界面所在仓库名</span><br><span class="line">git remote add origin git@github.com:nineya/nineya.github.io.git</span><br><span class="line"></span><br><span class="line"># 查看远程仓库地址，验证配置是否正确</span><br><span class="line">git remote -v</span><br><span class="line"></span><br><span class="line"># 新建分支blog_source</span><br><span class="line">git branch blog_source</span><br><span class="line"></span><br><span class="line"># 切换到blog_source分支</span><br><span class="line">git checkout blog_source</span><br></pre></td></tr></table></figure><p>3、提交数据到远程仓库：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 同步远程库上的数据，否则无法提交</span><br><span class="line">git pull origin hexo</span><br><span class="line"></span><br><span class="line"># 将所有文件添加到本地仓库</span><br><span class="line">git add -A</span><br><span class="line"></span><br><span class="line"># 提交到远程仓库</span><br><span class="line">git commit -m &quot;博客源文件&quot;</span><br><span class="line">git push origin hexo</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>github无法登陆</title>
      <link href="/0c8f1e9da251/"/>
      <url>/0c8f1e9da251/</url>
      
        <content type="html"><![CDATA[<p>1、打开网站<a href="https://www.ipaddress.com/ip-lookup">https://www.ipaddress.com/ip-lookup</a>;<br>2、查询如下两个主机名：<br>github.com<br>github.global.ssl.fastly.net<br>3、补充到C:\Windows\System32\drivers\etc\hosts文件的末尾，该文件不可编辑，可以复制到桌面，然后再复制回去实现替换。</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>物料批量查询</title>
      <link href="/40e7a726ccff/"/>
      <url>/40e7a726ccff/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import time</span><br><span class="line">import openpyxl</span><br><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">from selenium.webdriver.common.action_chains import ActionChains</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 进入登陆界面</span><br><span class="line">driver = webdriver.Edge()</span><br><span class="line">mes =  &#x27;MES网址&#x27;</span><br><span class="line">driver.get(mes)</span><br><span class="line">time.sleep(1)</span><br><span class="line"></span><br><span class="line"># 输入用户名</span><br><span class="line">driver.find_element(By.ID,&quot;userDto_loginName&quot;).send_keys(&quot;MES账号&quot;)</span><br><span class="line">time.sleep(1)</span><br><span class="line"></span><br><span class="line"># 输入密码</span><br><span class="line">driver.find_element(By.ID,&quot;keeper&quot;).send_keys(&quot;MES密码&quot;)</span><br><span class="line">time.sleep(1)</span><br><span class="line"></span><br><span class="line"># 选择账套</span><br><span class="line">driver.find_element(By.ID,&#x27;mcDataAuthB&#x27;).click()</span><br><span class="line"></span><br><span class="line"># 空点</span><br><span class="line">ActionChains(driver).move_by_offset(200,100).click().perform()</span><br><span class="line">time.sleep(1)</span><br><span class="line"></span><br><span class="line"># 点击登陆按钮</span><br><span class="line">driver.find_element(By.ID, &quot;loginButton&quot;).click()</span><br><span class="line">time.sleep(3)</span><br><span class="line"></span><br><span class="line"># 点击快捷方式</span><br><span class="line">driver.find_element(By.ID, &quot;infoDiv&quot;).click()</span><br><span class="line">time.sleep(1)</span><br><span class="line"></span><br><span class="line"># 点击库存查询</span><br><span class="line">driver.find_element(By.XPATH, &quot;/html/body/div[1]/div[1]/div/div[2]/div[3]/div/div[1]&quot;).click()</span><br><span class="line">time.sleep(5)</span><br><span class="line"></span><br><span class="line"># 进入库存查询框架</span><br><span class="line">iframe = driver.find_element(By.ID, &quot;iframe2&quot;)</span><br><span class="line">driver.switch_to.frame(iframe)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 查找当前文件夹.xlsx文件</span><br><span class="line">path = os.getcwd()</span><br><span class="line">files = os.listdir(path)</span><br><span class="line">excelfiles = [f for f in files if not f.startswith((&quot;~$&quot;)) and f.endswith((&quot;.xlsx&quot;))]</span><br><span class="line">for file in excelfiles:</span><br><span class="line">    fullpath = os.path.join(path,file)</span><br><span class="line"></span><br><span class="line"># 打开.xlsx文件默认sheet</span><br><span class="line">wb = openpyxl.load_workbook(fullpath)</span><br><span class="line">sheet = wb.active</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 定义查找函数</span><br><span class="line">def mes_clik(num):</span><br><span class="line">    cell = sheet[&quot;B&quot; + str(num)].value</span><br><span class="line">    v = driver.find_element(By.XPATH, &#x27;/html/body/div[1]/div/div[2]/div/form/div/div[1]/div[1]/div/div[2]/div[3]/input[1]&#x27;)</span><br><span class="line">    v.clear()</span><br><span class="line">    v.send_keys(cell) </span><br><span class="line">    time.sleep(1) </span><br><span class="line"></span><br><span class="line">    # 点击查询按钮  </span><br><span class="line">    driver.find_element(By.XPATH, &quot;/html/body/div[1]/div/div[2]/div/form/div/div[1]/div[2]/div[1]/a[1]&quot;).click()</span><br><span class="line">    name = sheet[&quot;A&quot; + str(num)].value</span><br><span class="line">    num = sheet[&quot;C&quot; + str(num)].value</span><br><span class="line">    print(str(cell) + &#x27;需要&#x27; + str(num))</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"># 循环查找物料信息</span><br><span class="line">for i in range(2,100):</span><br><span class="line">    mes_clik(i)</span><br><span class="line">    input(&quot;按Enter键继续\n&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>站位表制作</title>
      <link href="/e90c9de32b2a/"/>
      <url>/e90c9de32b2a/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=IF(ISNUMBER(VALUE(LEFT(INDIRECT(&quot;C&quot;&amp;ROW()),1))),LEFT(INDIRECT(&quot;C&quot;&amp;ROW()),1),INDIRECT(&quot;A&quot;&amp;ROW()-1))</span><br></pre></td></tr></table></figure><p>判断C列内容左边第1个字符是否为数字；如果是，显示该数字；否则显示A列上一单元格内容。</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Selenium模拟点击</title>
      <link href="/387d40756f5c/"/>
      <url>/387d40756f5c/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()  # 打开谷歌浏览器</span><br><span class="line">url = &#x27;https://www.baidu.com/&#x27;</span><br><span class="line">driver.get(url)  # 输入网址</span><br><span class="line"> </span><br><span class="line"># 输入搜索关键词并点击搜索按钮</span><br><span class="line">v = driver.find_element(By.ID, &#x27;kw&#x27;)  # 查找搜索输入框</span><br><span class="line">v.send_keys(&#x27;不想搬砖怎么办？&#x27;)  # 输入关键词</span><br><span class="line">time.sleep(3)  # 等待页面加载完成</span><br><span class="line"></span><br><span class="line">btn = driver.find_element(By.ID, &#x27;su&#x27;)  # 查找搜索按钮</span><br><span class="line">btn.click()  # 点击搜索按钮</span><br><span class="line"></span><br><span class="line">time.sleep(60)  # 等待搜索结果页面加载完成</span><br><span class="line"></span><br><span class="line">driver.quit()  # 关闭浏览器</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Win组合快捷键</title>
      <link href="/72f35f53ef71/"/>
      <url>/72f35f53ef71/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th align="left">快捷键</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">Win+E</td><td align="left">打开我的电脑</td></tr><tr><td align="left">Win+D</td><td align="left">返回桌面</td></tr><tr><td align="left">Win+L</td><td align="left">锁定计算机</td></tr><tr><td align="left">Win+R</td><td align="left">开启运行对话框</td></tr><tr><td align="left">Win+M</td><td align="left">最小化所有窗口</td></tr><tr><td align="left">Win+U</td><td align="left">打开设置页面</td></tr><tr><td align="left">Win+TAB</td><td align="left">窗口切换</td></tr><tr><td align="left">Win+Break</td><td align="left">打开电脑配置窗口</td></tr><tr><td align="left">Win+数字键</td><td align="left">切换任务窗口</td></tr><tr><td align="left">Win+方向键</td><td align="left">应用分屏</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>提取指定符号后字符串</title>
      <link href="/44644c465697/"/>
      <url>/44644c465697/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=IFERROR(TRIM(MID(SUBSTITUTE(B2,&quot;|&quot;,REPT(&quot; &quot;,100)),1,100)),&quot;&quot;)</span><br></pre></td></tr></table></figure><p>REPT函数用来重复空格100次</p><p>SUBSTITUTE将字符替换为指定内容</p><p>MID函数用来提取字符串中间部分的字符</p><p>TRIM函数去除空格</p><p>IFERROR函数将错误转换空文本</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>视频剪辑</title>
      <link href="/6e6d5a546e90/"/>
      <url>/6e6d5a546e90/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from moviepy.editor import *</span><br><span class="line"></span><br><span class="line"># 打开视频文件</span><br><span class="line">video = VideoFileClip(&#x27;dark.mp4&#x27;)</span><br><span class="line"></span><br><span class="line"># 剪辑视频</span><br><span class="line">video2 = video.subclip(0,1)</span><br><span class="line"></span><br><span class="line"># 添加文字、位置、显示时间</span><br><span class="line">text = (TextClip(&quot;WPS&quot;,fontsize =20,color =&quot;white&quot;,font =&quot;黑体&quot;)</span><br><span class="line">        .set_position(&#x27;center&#x27;)</span><br><span class="line">        .set_duration(0.5))</span><br><span class="line">        </span><br><span class="line"># 在视频上加载文本</span><br><span class="line">video_with_text = CompositeVideoClip([video2,text])</span><br><span class="line"></span><br><span class="line"># 保存为新文件</span><br><span class="line">video_with_text.write_videofile(&#x27;new_1.mp4&#x27;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>拆分工作薄</title>
      <link href="/73ddf36be0ed/"/>
      <url>/73ddf36be0ed/</url>
      
        <content type="html"><![CDATA[<p>将工作薄中的Excel工作表拆分为单独的工作薄</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import xlwings as xw</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">def split_excel(file_path):</span><br><span class="line">    app = xw.App(visible=False, add_book=False)</span><br><span class="line">    </span><br><span class="line">    workbook = app.books.open(file_path)</span><br><span class="line">    worksheet = workbook.sheets</span><br><span class="line">    for i in worksheet:  # 遍历工作簿中所有工作表</span><br><span class="line">        new_workbook = app.books.add()  # 新建工作簿</span><br><span class="line">        new_worksheet = new_workbook.sheets[0]  # 选中新建工作簿中的第1张工作表</span><br><span class="line">        i.copy(before=new_worksheet)  # 将原来工作簿中的当前工作表复制到新建工作簿的第1张工作表之前</span><br><span class="line">        new_workbook.sheets[1].delete()  #删除空白工作表</span><br><span class="line">        new_workbook.save(&#x27;拆分\&#123;&#125;.xlsx&#x27;.format(i.name))  # 保存新工作簿</span><br><span class="line">        print(&#x27;&#123;&#125;.xlsx&#x27;.format(i.name) + &quot;拆分完成&quot;)</span><br><span class="line">        new_workbook.close()  # 关闭新工作薄</span><br><span class="line">    workbook.close()   # 关闭旧工作薄</span><br><span class="line"></span><br><span class="line">def find_excel():</span><br><span class="line">    path = os.getcwd()</span><br><span class="line">    files = os.listdir(path)</span><br><span class="line">    if not os.path.exists(&quot;拆分&quot;):   #检查如果没有“拆分”文件夹</span><br><span class="line">        os.mkdir(&quot;拆分&quot;)   #创建“拆分”文件夹</span><br><span class="line">    excelfiles = [f for f in files if not f.startswith((&quot;~$&quot;)) and f.endswith((&quot;.xlsx&quot;))]  #过滤当前所有xlsx文件</span><br><span class="line">    for file in excelfiles:   #遍历所有xlsx文件</span><br><span class="line">        fullpath = os.path.join(path,file) </span><br><span class="line">        split_excel(fullpath)   #对xlsx文件进行拆分</span><br><span class="line"></span><br><span class="line">find_excel()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>将工作薄转换为PDF</title>
      <link href="/1438746c1752/"/>
      <url>/1438746c1752/</url>
      
        <content type="html"><![CDATA[<p>将EXCEL中的所有工作表转换为一个PDF文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import win32com.client,os</span><br><span class="line">  </span><br><span class="line">def excel_to_pdf(excel_path, pdf_path):  </span><br><span class="line">    excel = win32com.client.Dispatch(&quot;Excel.Application&quot;)  </span><br><span class="line">    excel.Visible = False    </span><br><span class="line">    wb = excel.Workbooks.Open(excel_path)  </span><br><span class="line">  </span><br><span class="line">    wb.ExportAsFixedFormat(  </span><br><span class="line">        Type=0,  </span><br><span class="line">        Filename=pdf_path,  </span><br><span class="line">        Quality=win32com.client.constants.xlQualityStandard,  </span><br><span class="line">        IncludeDocProperties=True,  </span><br><span class="line">        IgnorePrintAreas=False,  </span><br><span class="line">        OpenAfterPublish=False  </span><br><span class="line">    )  </span><br><span class="line">  </span><br><span class="line">    wb.Close(SaveChanges=False)</span><br><span class="line">    excel.Quit()</span><br><span class="line"></span><br><span class="line">def excel_file():</span><br><span class="line">    path = os.getcwd()</span><br><span class="line">    files = os.listdir(path)</span><br><span class="line">    if not os.path.exists(&quot;pdf&quot;):</span><br><span class="line">        os.mkdir(&quot;pdf&quot;)</span><br><span class="line">    excelfiles = [f for f in files if not f.startswith((&quot;~$&quot;)) and f.endswith((&quot;.xlsx&quot;))]</span><br><span class="line">    for file in excelfiles:</span><br><span class="line">        excel_path = os.path.join(path,file)</span><br><span class="line">        pdf_name = os.path.splitext(file)[0]</span><br><span class="line">        pdf_path = path + &quot;\\&quot; + &quot;pdf&quot; + &quot;\\&quot; + pdf_name + &quot;.pdf&quot;</span><br><span class="line">        excel_to_pdf(excel_path, pdf_path)</span><br><span class="line">        print(excel_path+&quot;格式转换完成&quot;)</span><br><span class="line">    </span><br><span class="line">excel_file()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>批量调整Excel表格格式</title>
      <link href="/ed8a2818c05f/"/>
      <url>/ed8a2818c05f/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import openpyxl</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">def excel_col(file_name):</span><br><span class="line">    wb = openpyxl.load_workbook(file_name)</span><br><span class="line">    sheet = wb.active</span><br><span class="line"></span><br><span class="line">    for row in sheet.iter_rows():</span><br><span class="line">        for cell in row:</span><br><span class="line">            cell.font=openpyxl.styles.Font(name=&#x27;宋体&#x27;)</span><br><span class="line">            cell.font=openpyxl.styles.Font(name=&#x27;Times New Roman&#x27;,size=12)</span><br><span class="line">            </span><br><span class="line">    sheet.column_dimensions[&#x27;B&#x27;].width = 6</span><br><span class="line">    sheet.column_dimensions[&#x27;C&#x27;].width = 18</span><br><span class="line">    sheet.column_dimensions[&#x27;D&#x27;].width = 25</span><br><span class="line"></span><br><span class="line">    sheet[&#x27;A1&#x27;].font=openpyxl.styles.Font(name=&#x27;宋体&#x27;,size=20,bold=True)</span><br><span class="line">    sheet[&#x27;G1&#x27;].font=openpyxl.styles.Font(name=&#x27;宋体&#x27;,size=12,bold=True)</span><br><span class="line">    sheet[&#x27;G2&#x27;].font=openpyxl.styles.Font(name=&#x27;宋体&#x27;,size=12,bold=True)</span><br><span class="line"></span><br><span class="line">    wb.save(file_name)</span><br><span class="line"></span><br><span class="line">def excel_file():</span><br><span class="line">    path = os.getcwd()</span><br><span class="line">    files = os.listdir(path)</span><br><span class="line">    excelfiles = [f for f in files if not f.startswith((&quot;~$&quot;)) and f.endswith((&quot;.xlsx&quot;))]</span><br><span class="line">    for file in excelfiles:</span><br><span class="line">        fullpath = os.path.join(path,file)</span><br><span class="line">        excel_col(fullpath)</span><br><span class="line">        print(fullpath + &quot;格式调整完成&quot;)</span><br><span class="line"></span><br><span class="line">excel_file()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>生成词云</title>
      <link href="/c3661aa7c1e8/"/>
      <url>/c3661aa7c1e8/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">from wordcloud import WordCloud</span><br><span class="line"></span><br><span class="line"># 读取Excel文件</span><br><span class="line">data = pd.read_excel(&#x27;index.xlsx&#x27;)</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"></span><br><span class="line"># 从DataFrame中提取数据</span><br><span class="line">text = df[&#x27;Name&#x27;]</span><br><span class="line">text1 = &#x27; &#x27;.join(df[&#x27;Name&#x27;])</span><br><span class="line">print(text)</span><br><span class="line">print(text1)</span><br><span class="line"></span><br><span class="line"># 创建词云对象</span><br><span class="line">wordcloud = WordCloud(background_color=&#x27;white&#x27;).generate(text1)</span><br><span class="line"></span><br><span class="line"># 展示词云</span><br><span class="line">plt.imshow(wordcloud, interpolation=&#x27;bilinear&#x27;)</span><br><span class="line">plt.axis(&#x27;off&#x27;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>打印文件夹内所有Excel文件</title>
      <link href="/187902d39aaa/"/>
      <url>/187902d39aaa/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import win32com.client as win32</span><br><span class="line"></span><br><span class="line">def init_excel(print_file):</span><br><span class="line">    excel = win32.gencache.EnsureDispatch(&#x27;Excel.Application&#x27;)</span><br><span class="line">    wb = excel.Workbooks.Open(print_file)</span><br><span class="line">    ws = wb.Sheets(&#x27;Sheet1&#x27;)</span><br><span class="line">    ws.PrintOut()</span><br><span class="line">    wb.Close(False)</span><br><span class="line">    excel.Quit()</span><br><span class="line"></span><br><span class="line">def excel_file():</span><br><span class="line">    path = os.getcwd()</span><br><span class="line">    files = os.listdir(path)</span><br><span class="line">    excelfiles = [f for f in files if not f.startswith((&quot;~$&quot;)) and f.endswith((&quot;.xlsx&quot;))]</span><br><span class="line">    for file in excelfiles:</span><br><span class="line">        fullpath = os.path.join(path,file)</span><br><span class="line">        print(fullpath)</span><br><span class="line">        init_excel(fullpath)</span><br><span class="line"></span><br><span class="line">excel_file()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Office批量转PDF</title>
      <link href="/8242850dec0f/"/>
      <url>/8242850dec0f/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line">import os, win32com.client, gc</span><br><span class="line"></span><br><span class="line"># Word</span><br><span class="line">def word2Pdf(filePath, words):</span><br><span class="line">    # 如果没有文件则提示后直接退出</span><br><span class="line">    if(len(words)&lt;1):</span><br><span class="line">        print (&quot;\n【无 Word 文件】\n&quot;)</span><br><span class="line">        return</span><br><span class="line">    # 开始转换</span><br><span class="line">    print (&quot;\n【开始 Word -&gt; PDF 转换】&quot;)</span><br><span class="line">    try:</span><br><span class="line">        print (&quot;打开 Word 进程...&quot;)</span><br><span class="line">        word = win32com.client.Dispatch(&quot;Word.Application&quot;)</span><br><span class="line">        word.Visible = 0</span><br><span class="line">        word.DisplayAlerts = False</span><br><span class="line">        doc = None</span><br><span class="line">        for i in range(len(words)):</span><br><span class="line">            print(i)</span><br><span class="line">            fileName = words[i] # 文件名称</span><br><span class="line">            fromFile = os.path.join(filePath, fileName) # 文件地址</span><br><span class="line">            toFileName = changeSufix2Pdf(fileName) # 生成的文件名称</span><br><span class="line">            toFile = toFileJoin(filePath,toFileName) # 生成的文件地址</span><br><span class="line"></span><br><span class="line">            print (&quot;转换：&quot;+fileName+&quot;文件中...&quot;)</span><br><span class="line">            # 某文件出错不影响其他文件打印</span><br><span class="line">            try:</span><br><span class="line">                doc = word.Documents.Open(fromFile)</span><br><span class="line">                doc.SaveAs(toFile,17) # 生成的所有 PDF 都会在 PDF 文件夹中</span><br><span class="line">                print (&quot;转换到：&quot;+toFileName+&quot;完成&quot;)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                print(e)</span><br><span class="line">            # 关闭 Word 进程</span><br><span class="line">        print (&quot;所有 Word 文件已打印完毕&quot;)</span><br><span class="line">        print (&quot;结束 Word 进程...\n&quot;)</span><br><span class="line">        doc.Close()</span><br><span class="line">        doc = None</span><br><span class="line">        word.Quit()</span><br><span class="line">        word = None</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(e)</span><br><span class="line">    finally:</span><br><span class="line">        gc.collect()</span><br><span class="line"></span><br><span class="line"># Excel</span><br><span class="line">def excel2Pdf(filePath, excels):</span><br><span class="line">    # 如果没有文件则提示后直接退出</span><br><span class="line">    if(len(excels)&lt;1):</span><br><span class="line">        print (&quot;\n【无 Excel 文件】\n&quot;)</span><br><span class="line">        return</span><br><span class="line">    # 开始转换</span><br><span class="line">    print (&quot;\n【开始 Excel -&gt; PDF 转换】&quot;)</span><br><span class="line">    try:</span><br><span class="line">        print (&quot;打开 Excel 进程中...&quot;)</span><br><span class="line">        excel = win32com.client.Dispatch(&quot;Excel.Application&quot;)</span><br><span class="line">        excel.Visible = 0</span><br><span class="line">        excel.DisplayAlerts = False</span><br><span class="line">        wb = None</span><br><span class="line">        ws = None</span><br><span class="line">        for i in range(len(excels)):</span><br><span class="line">            print(i)</span><br><span class="line">            fileName = excels[i] # 文件名称</span><br><span class="line">            fromFile = os.path.join(filePath, fileName) # 文件地址</span><br><span class="line">           </span><br><span class="line">            print (&quot;转换：&quot;+fileName+&quot;文件中...&quot;)</span><br><span class="line">            # 某文件出错不影响其他文件打印</span><br><span class="line">            try:</span><br><span class="line">                wb = excel.Workbooks.Open(fromFile)</span><br><span class="line">                for j in range(wb.Worksheets.Count): # 工作表数量，一个工作簿可能有多张工作表</span><br><span class="line">                    toFileName = addWorksheetsOrder(fileName, j+1) # 生成的文件名称</span><br><span class="line">                    toFile = toFileJoin(filePath,toFileName) # 生成的文件地址</span><br><span class="line">                   </span><br><span class="line">                    ws = wb.Worksheets(j+1) # 若为[0]则打包后会提示越界</span><br><span class="line">                    ws.ExportAsFixedFormat(0,toFile) # 每一张都需要打印</span><br><span class="line">                    print (&quot;转换至：&quot;+toFileName+&quot;文件完成&quot;)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                print(e)</span><br><span class="line">        # 关闭 Excel 进程</span><br><span class="line">        print (&quot;所有 Excel 文件已打印完毕&quot;)</span><br><span class="line">        print (&quot;结束 Excel 进程中...\n&quot;)</span><br><span class="line">        ws = None</span><br><span class="line">        wb.Close()</span><br><span class="line">        wb = None</span><br><span class="line">        excel.Quit()</span><br><span class="line">        excel = None</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(e)</span><br><span class="line">    finally:</span><br><span class="line">        gc.collect()</span><br><span class="line"></span><br><span class="line"># PPT</span><br><span class="line">def ppt2Pdf(filePath, ppts):</span><br><span class="line">    # 如果没有文件则提示后直接退出</span><br><span class="line">    if(len(ppts)&lt;1):</span><br><span class="line">        print (&quot;\n【无 PPT 文件】\n&quot;)</span><br><span class="line">        return</span><br><span class="line">    # 开始转换</span><br><span class="line">    print (&quot;\n【开始 PPT -&gt; PDF 转换】&quot;)</span><br><span class="line">    try:</span><br><span class="line">        print (&quot;打开 PowerPoint 进程中...&quot;)</span><br><span class="line">        powerpoint = win32com.client.Dispatch(&quot;PowerPoint.Application&quot;)</span><br><span class="line">        ppt = None</span><br><span class="line">        # 某文件出错不影响其他文件打印</span><br><span class="line"></span><br><span class="line">        for i in range(len(ppts)):</span><br><span class="line">            print(i)</span><br><span class="line">            fileName = ppts[i] # 文件名称</span><br><span class="line">            fromFile = os.path.join(filePath, fileName) # 文件地址</span><br><span class="line">            toFileName = changeSufix2Pdf(fileName) # 生成的文件名称</span><br><span class="line">            toFile = toFileJoin(filePath,toFileName) # 生成的文件地址</span><br><span class="line"></span><br><span class="line">            print (&quot;转换：&quot;+fileName+&quot;文件中...&quot;)</span><br><span class="line">            try:</span><br><span class="line">                ppt = powerpoint.Presentations.Open(fromFile,WithWindow=False)</span><br><span class="line">                if ppt.Slides.Count&gt;0:</span><br><span class="line">                    ppt.SaveAs(toFile, 32) # 如果为空则会跳出提示框（暂时没有找到消除办法）</span><br><span class="line">                    print (&quot;转换至：&quot;+toFileName+&quot;文件完成&quot;)</span><br><span class="line">                else:</span><br><span class="line">                    print(&quot;（错误，发生意外：此文件为空，跳过此文件）&quot;)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                print(e)</span><br><span class="line">        # 关闭 PPT 进程</span><br><span class="line">        print (&quot;所有 PPT 文件已打印完毕&quot;)</span><br><span class="line">        print (&quot;结束 PowerPoint 进程中...\n&quot;)</span><br><span class="line">        ppt.Close()</span><br><span class="line">        ppt = None</span><br><span class="line">        powerpoint.Quit()</span><br><span class="line">        powerpoint = None</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(e)</span><br><span class="line">    finally:</span><br><span class="line">        gc.collect()</span><br><span class="line"></span><br><span class="line"># 修改后缀名</span><br><span class="line">def changeSufix2Pdf(file):</span><br><span class="line">    return file[:file.rfind(&#x27;.&#x27;)]+&quot;.pdf&quot;</span><br><span class="line"># 添加工作簿序号</span><br><span class="line">def addWorksheetsOrder(file, i):</span><br><span class="line">    return file[:file.rfind(&#x27;.&#x27;)]+&quot;_工作表&quot;+str(i)+&quot;.pdf&quot;</span><br><span class="line"># 转换地址</span><br><span class="line">def toFileJoin(filePath,file):</span><br><span class="line">    return os.path.join(filePath,&#x27;pdf&#x27;,file[:file.rfind(&#x27;.&#x27;)]+&quot;.pdf&quot;)</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 开始程序</span><br><span class="line">print (&quot;====================程序开始====================&quot;)</span><br><span class="line">print (&quot;【程序功能】将目标路径下内所有的 ppt、excel、word 均生成一份对应的 PDF 文件，存在新生成的 pdf 文件夹中（需已经安装office，不包括子文件夹）&quot;)</span><br><span class="line">print (&quot;注意：若某 PPT 和 Excel 文件为空，则会出错跳过此文件。若转换 PPT 时间过长，请查看是否有报错窗口等待确认，暂时无法彻底解决 PPT 的窗口问题（为空错误已解决）。在关闭进程过程中，时间可能会较长，十秒左右，请耐心等待。&quot;)</span><br><span class="line">filePath = input (&quot;输入目标路径：(若为当前路径：&quot;+os.getcwd()+&quot;，请直接回车）\n&quot;)</span><br><span class="line"></span><br><span class="line"># 目标路径，若没有输入路径则为当前路径</span><br><span class="line">if(filePath==&quot;&quot;):</span><br><span class="line">    filePath = os.getcwd()</span><br><span class="line"></span><br><span class="line"># 将目标文件夹所有文件归类，转换时只打开一个进程</span><br><span class="line">words = []</span><br><span class="line">ppts = []</span><br><span class="line">excels = []</span><br><span class="line"></span><br><span class="line">for fn in os.listdir(filePath):</span><br><span class="line">    if fn.endswith((&#x27;.doc&#x27;, &#x27;docx&#x27;)):</span><br><span class="line">        words.append(fn)</span><br><span class="line">    if fn.endswith((&#x27;.ppt&#x27;, &#x27;pptx&#x27;)):</span><br><span class="line">        ppts.append(fn)</span><br><span class="line">    if fn.endswith((&#x27;.xls&#x27;, &#x27;xlsx&#x27;)):</span><br><span class="line">        excels.append(fn)</span><br><span class="line"></span><br><span class="line"># 调用方法</span><br><span class="line">print (&quot;====================开始转换====================&quot;)</span><br><span class="line"></span><br><span class="line"># 新建 pdf 文件夹，所有生成的 PDF 文件都放在里面</span><br><span class="line">folder = filePath + &#x27;\\pdf\\&#x27;</span><br><span class="line">if not os.path.exists(folder):</span><br><span class="line">    os.makedirs(folder)</span><br><span class="line"></span><br><span class="line">word2Pdf(filePath,words)</span><br><span class="line">excel2Pdf(filePath,excels)</span><br><span class="line">ppt2Pdf(filePath,ppts)</span><br><span class="line">print (&quot;====================转换结束====================&quot;)</span><br><span class="line">print (&quot;\n====================程序结束====================&quot;)</span><br><span class="line">os.system(&quot;pause&quot;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PPT批量转换PDF</title>
      <link href="/2f180d7aec4d/"/>
      <url>/2f180d7aec4d/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import comtypes.client</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">def init_powerpoint():</span><br><span class="line">    powerpoint=comtypes.client.CreateObject(&quot;Powerpoint.Application&quot;)</span><br><span class="line">    powerpoint.Visible=1</span><br><span class="line">    return powerpoint</span><br><span class="line"></span><br><span class="line">def ppt_to_pdf(powerpoint,inputFileName,outputFileName,formatType=32):</span><br><span class="line">    if outputFileName[-3:] != &#x27;pdf&#x27;:</span><br><span class="line">        outputFileName=outputFileName+&#x27;.pdf&#x27;</span><br><span class="line">    deck=powerpoint.Presentations.Open(inputFileName)</span><br><span class="line">    deck.SaveAs(outputFileName,formatType)</span><br><span class="line">    deck.Close()</span><br><span class="line">def convert_files_folder(powerpoint,folder):</span><br><span class="line">    files=os.listdir(folder)</span><br><span class="line">    pptfiles=[f for f in files if f.endswith((&quot;.ppt&quot;,&quot;.pptx&quot;))]</span><br><span class="line">    for pptfile in pptfiles:</span><br><span class="line">        fullpath=os.path.join(folder,pptfile)</span><br><span class="line">        ppt_to_pdf(powerpoint,fullpath,fullpath)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    powerpoint=init_powerpoint()</span><br><span class="line">    cwd=os.getcwd()</span><br><span class="line">    convert_files_folder(powerpoint,cwd)</span><br><span class="line">    powerpoint.Quit()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>win32打印工作表</title>
      <link href="/63b0d53a5fcb/"/>
      <url>/63b0d53a5fcb/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import win32com.client as win32</span><br><span class="line"></span><br><span class="line">excel = win32.gencache.EnsureDispatch(&#x27;Excel.Application&#x27;)</span><br><span class="line"></span><br><span class="line">wb = excel.Workbooks.Open(r&#x27;C:\123.xlsx&#x27;)</span><br><span class="line">ws = wb.Sheets(&#x27;Sheet1&#x27;) </span><br><span class="line"></span><br><span class="line">ws.PrintOut()</span><br><span class="line"></span><br><span class="line">wb.Close(False)</span><br><span class="line">excel.Quit()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>批量成生二维码</title>
      <link href="/25b33f19986c/"/>
      <url>/25b33f19986c/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import qrcode</span><br><span class="line">import openpyxl</span><br><span class="line">from openpyxl.drawing.image import Image</span><br><span class="line"></span><br><span class="line">def open_cell(num):</span><br><span class="line">cell = sheet[&quot;A&quot; + num]</span><br><span class="line">return cell.value</span><br><span class="line"></span><br><span class="line">def gen_image(text,name):</span><br><span class="line">img = qrcode.make(text)</span><br><span class="line">with open(name,&quot;wb&quot;) as f:</span><br><span class="line">img.save(f)</span><br><span class="line"></span><br><span class="line">def write_img(img_name,position):</span><br><span class="line">imgsize = (720/12,720/12)</span><br><span class="line">img = Image(img_name)</span><br><span class="line">img.width,img.height = imgsize</span><br><span class="line">sheet.add_image(img,position)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">wb_name = &quot;text.xlsx&quot;</span><br><span class="line">wb = openpyxl.load_workbook(wb_name)</span><br><span class="line">sheet = wb.worksheets[0]</span><br><span class="line">if not os.path.exists(&quot;qrcode&quot;):</span><br><span class="line">os.mkdir(&quot;qrcode&quot;)</span><br><span class="line"></span><br><span class="line">for i in range(1,10):</span><br><span class="line">test = open_cell(str(i))</span><br><span class="line">test_png_name = &quot;qrcode/&quot; + &quot;A&quot; + str(i) + &quot;.png&quot;</span><br><span class="line">paste = &quot;B&quot; + str(i)</span><br><span class="line">gen_image(test,test_png_name)</span><br><span class="line">write_img(test_png_name,paste)</span><br><span class="line"></span><br><span class="line">wb.save(wb_name)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>生成SSH</title>
      <link href="/e8b64cf00e4d/"/>
      <url>/e8b64cf00e4d/</url>
      
        <content type="html"><![CDATA[<ul><li><p>用户名和邮箱进行初始化<br>git config –global user.name yourname<br>git config –global user.email youremail</p><span id="more"></span></li><li><p>检查初始化信息<br>git config user.name<br>git config user.email</p></li><li><p>生成密钥<br>ssh-keygen -t rsa -C youremail</p></li><li><p>查看公钥<br>cat ~&#x2F;.ssh&#x2F;id_rsa.pub</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo常用命令</title>
      <link href="/405b5fcaa8ae/"/>
      <url>/405b5fcaa8ae/</url>
      
        <content type="html"><![CDATA[<p>在Hexo中可以使用的一些常用命令包括:</p><span id="more"></span><table><thead><tr><th align="left">命令</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">hexo cl</td><td align="left">清理缓存文件</td></tr><tr><td align="left">hexo g</td><td align="left">生成静态文件</td></tr><tr><td align="left">hexo d</td><td align="left">部署网站</td></tr><tr><td align="left">hexo s</td><td align="left">启动本地服务器</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在一个工作薄内复制多个工作表</title>
      <link href="/78ed4360b2d1/"/>
      <url>/78ed4360b2d1/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import openpyxl</span><br><span class="line"></span><br><span class="line">print(&quot;注意：&quot;+&quot;\n&quot;</span><br><span class="line">&quot;1、此程序只支持XLSX格式文件；&quot;+&quot;\n&quot;</span><br><span class="line">&quot;2、程序运行前需调整好打印预览模式；&quot;+&quot;\n&quot;</span><br><span class="line">&quot;3、程序不会复制图片，运行完成后需手动复制图片。&quot;+&quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">wb_name = input(&quot;请输入文件名称：&quot;)</span><br><span class="line">wb = openpyxl.load_workbook(f&#x27;&#123;wb_name&#125;.xlsx&#x27;)</span><br><span class="line">old_sheet = wb.worksheets[0]</span><br><span class="line">sheet_name = old_sheet.title</span><br><span class="line"></span><br><span class="line">num = int(input(&quot;请输入需要复制的数量：&quot;))</span><br><span class="line"></span><br><span class="line">for i in range(2,num+1):</span><br><span class="line">new_sheet = wb.copy_worksheet(old_sheet)</span><br><span class="line">new_sheet.title = sheet_name + str(i)</span><br><span class="line"></span><br><span class="line">print(&quot;已生成&quot;f&#x27;&#123;num&#125;&#x27;&quot;个sheet&quot;)    </span><br><span class="line">wb.save(f&#x27;&#123;wb_name&#125;.xlsx&#x27;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在单元格中显示当前工作表名称</title>
      <link href="/c1580615619d/"/>
      <url>/c1580615619d/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=RIGHT(CELL(&quot;filename&quot;),LEN(CELL(&quot;filename&quot;))-FIND(&quot;]&quot;,CELL(&quot;filename&quot;)))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Termux常用命令</title>
      <link href="/fffa3116e0d4/"/>
      <url>/fffa3116e0d4/</url>
      
        <content type="html"><![CDATA[<p>Termux是一个Android上的终端模拟器和Linux环境。它允许用户在其Android设备上直接运行各种 Linux 命令行实用程序。<br>在Termux中可以使用的一些常用命令包括:</p><span id="more"></span><table><thead><tr><th align="left">命令</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">ls：</td><td align="left">列出目录及文件名</td></tr><tr><td align="left">cd：</td><td align="left">切换目录</td></tr><tr><td align="left">pwd：</td><td align="left">显示当前目录</td></tr><tr><td align="left">mkdir：</td><td align="left">创建新目录</td></tr><tr><td align="left">rmdir：</td><td align="left">删除空目录</td></tr><tr><td align="left">cp：</td><td align="left">复制文件</td></tr><tr><td align="left">rm：</td><td align="left">删除文件</td></tr><tr><td align="left">mv：</td><td align="left">移动&#x2F;重命名文件</td></tr><tr><td align="left">cl：</td><td align="left">清空终端屏幕</td></tr><tr><td align="left">touch：</td><td align="left">创建一个空文件</td></tr><tr><td align="left">wget：</td><td align="left">下载文件</td></tr><tr><td align="left">tar：</td><td align="left">压缩&#x2F;解压文件</td></tr><tr><td align="left">termux-setup-storage</td><td align="left">获取存储权限</td></tr><tr><td align="left">termux-change-repo</td><td align="left">换源</td></tr><tr><td align="left">pkg update</td><td align="left">更新包目录</td></tr><tr><td align="left">pkg upgrade</td><td align="left">更新已安装包</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多条件查找</title>
      <link href="/06c6fd71420b/"/>
      <url>/06c6fd71420b/</url>
      
        <content type="html"><![CDATA[<p>&#x3D;LOOKUP(1,0&#x2F;((B2:B9&#x3D;G3)*(C2:C9&#x3D;H3)),D2:D9)，以此函数为例：</p><p>&#x3D;LOOKUP(1,0&#x2F;((条件1)*(条件2)),结果列）</p><span id="more"></span><p>（1）当“0&#x2F;条件所在区域&#x3D;条件”这部分数据中的条件所在区域&#x3D;条件，那么分母项是为1的，整个运算“0&#x2F;条件所在区域&#x3D;条件”就等于“0&#x2F;1”，结果就是0；</p><p>（2）当“0&#x2F;条件所在区域&#x3D;条件”这部分数据中的条件所在区域不等于条件，那么分母项是为0的，整个运算“0&#x2F;条件所在区域&#x3D;条件”就等于“0&#x2F;0”，结果就是错误值；</p><p>此时，只有条件所在区域&#x3D;条件的时候，&#x3D;LOOKUP(1，0&#x2F;条件所在区域&#x3D;条件，结果所在区域）此公式才有意义，找到唯一符合的条件时，就能做出对应的结果。</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>格式化字符串的三种方法</title>
      <link href="/01d89f1c8cbf/"/>
      <url>/01d89f1c8cbf/</url>
      
        <content type="html"><![CDATA[<p>f’{i}*{j}&#x3D;{i*j}’<br>‘{}*{}&#x3D;{}’.format(i,j,i*j)<br>‘%d*%d&#x3D;%d’%(i,j,i*j)</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>条件查找</title>
      <link href="/57d97a19bcb5/"/>
      <url>/57d97a19bcb5/</url>
      
        <content type="html"><![CDATA[<p>&#x3D;VLOOKUP(A1,A:C,3,1)，以此函数为例：<br>“A1”为“查找值”内容，当前需要查找的目标；<br>“A:C”为“数据表”内容，查找表中的目标起始列和结果终止列；<br>“3”为“列序数”内容，“数据表”中目标列至结果列的列数；<br>“1”为“匹配条件”内容，“0”为精确查找，“1”为模糊查找。</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>双for打印九九乘法表</title>
      <link href="/b13826e78dd7/"/>
      <url>/b13826e78dd7/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for i in range(1, 10):</span><br><span class="line">for j in range(1, i + 1):</span><br><span class="line">print(&#x27;&#123;&#125;\*&#123;&#125;=&#123;&#125;&#x27;.format(i,j,i\*j), end=&#x27;\t&#x27;)</span><br><span class="line">print()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PDF转图片</title>
      <link href="/f9257d9b155a/"/>
      <url>/f9257d9b155a/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import fitz  # fitz就是pip install PyMuPDF</span><br><span class="line"></span><br><span class="line">def pyMuPDF_fitz(pdfPath, imagePath):</span><br><span class="line">print(&quot;imagePath=&quot; + imagePath)</span><br><span class="line">pdfDoc = fitz.open(pdfPath)</span><br><span class="line">for pg in range(pdfDoc.pageCount):</span><br><span class="line">page = pdfDoc[pg]</span><br><span class="line">rotate = int(0)</span><br><span class="line">\#每个尺寸的缩放系数为1.3，这将为我们生成分辨率提高2.6的图像。</span><br><span class="line">\#此处若是不做设置，默认图片大小为：792X612, dpi=96</span><br><span class="line">zoom_x = 1.33333333  # (1.33333333--&gt;1056x816)   (2--&gt;1584x1224)</span><br><span class="line">zoom_y = 1.33333333</span><br><span class="line">mat = fitz.Matrix(zoom_x, zoom_y).preRotate(rotate)</span><br><span class="line">pix = page.getPixmap(matrix=mat, alpha=False)</span><br><span class="line"></span><br><span class="line">if not os.path.exists(imagePath):  # 判断存放图片的文件夹是否存在</span><br><span class="line">os.makedirs(imagePath)  # 若图片文件夹不存在就创建</span><br><span class="line"></span><br><span class="line">pix.writePNG(imagePath + &#x27;/&#x27; + &#x27;images_%s.png&#x27; % pg)  # 将图片写入指定的文件夹内</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">pdfPath = &#x27;123.pdf&#x27;</span><br><span class="line">imagePath = &#x27;./imgs&#x27;</span><br><span class="line">pyMuPDF_fitz(pdfPath, imagePath)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL命令</title>
      <link href="/2bc2abe43af5/"/>
      <url>/2bc2abe43af5/</url>
      
        <content type="html"><![CDATA[<p>#创建一个名为“day1”的数据库<br>create database day1;</p><p>#进去day1数据库<br>use day1;<span id="more"></span></p><p>#创建一个名为“test”的数据表<br>create table test(<br>id varchar(20)  primary key ,<br>name varchar(30),<br>password varchar(30)<br>);</p><p>#向test表插入一行数据<br>insert into test(id,name,password) values(‘001’,’lisi’,’123456’);</p><p>#查看创建的test表的数据<br>select * from test;</p><p>#将id为001的密码改为xxxx<br>update test set password&#x3D;’xxxx’ where id&#x3D;’001’;</p><p>#删除test表<br>drop table test;</p><p>#删除day1数据库<br>drop database day1;</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Excel函数公式大全</title>
      <link href="/501ba1da54b3/"/>
      <url>/501ba1da54b3/</url>
      
        <content type="html"><![CDATA[<p>一、Excel中：逻辑函数，共有9个；<br>IF函数：&#x3D;IF(G2&gt;&#x3D;6000,”高薪”,”低薪”)<br>通过IF函数，判断条月薪是否大于6000；大于6000返回高薪，小于6000返回低薪；</p><span id="more"></span><p>IFS函数：&#x3D;IFS(G2&lt;6000,”员工”,G2&lt;10000,”经理”,G2&gt;&#x3D;10000,”老板”)<br>IFS函数，用于判断多个条件；判断月薪条件为：6000、8000、10000的员工，分别为：员工、经理、老板；</p><p>IFERROR函数：&#x3D;IFERROR（E2&#x2F;F2，“-”）<br>因为被除数不能为0 ，当【销量】为0时会报错，我们可以使用IFERROR函数，将报错信息转换为横杠；</p><p>二、Excel中：统计函数，共有103个；<br>SUM函数：&#x3D;SUM（G2：G9）<br>选中I2单元格，并在编辑栏输入函数公式：&#x3D;SUM（）；然后用鼠标选中G2：G9单元格区域，按回 车键结束确认，即可计算出所有员工的月薪总和；</p><p>SUMIF函数：&#x3D;SUMIF（F：F，I2，G：G）<br>SUMIF为单条件求和函数，通过判断【学历】是否为本科，可以计算出【学历】为本科的员工总工 资；</p><p>SUMIFS函数：&#x3D;SUMIFS(G2:G9,D2:D9,I3,G2:G9,”&gt;”&amp;K3)<br>SUMIFS为多条件求和函数；通过判断【性别】和【月薪】2个条件；计算出【性别】为：男性，【 月薪】大于6000的工资总和；</p><p>三、Excel中：统计函数，共有30个；<br>TEXT函数：&#x3D;TEXT(C2,”aaaa”) TEXT函数中的代码：“aaaa”，可以将日期格式，轻松转换成星期格式；</p><p>LEFT函数：&#x3D;LEFT(B2,1)<br>LEFT函数，用于截取文本中左侧的字符串，通过LEFT函数，可以返回：所有员工的姓氏；</p><p>RIGHT函数：&#x3D;RIGHT(B2,1)；<br>RIGHT函数，用于截取文本中右侧的字符串，通过RIGHT函数，可以返回：所有员工的名字；</p><p>四、Excel中：时间函数，共有25个；<br>YEAR函数：&#x3D;YEAR（C2）<br>YEAR函数，用于返回时间格式的年份，使用YEAR函数，可以批量返回：员工【出生日期】的年份 ；</p><p>MONTH函数：&#x3D;MONTH（C2）<br>MONTH函数，用于返回时间格式的月份，使用MONTH函数，可以批量返回：员工【出生日期】的月 份；</p><p>DAY函数：&#x3D;DAY（C2）<br>DAY函数，用于返回时间格式的日期，使用DAY函数，可以批量返回：员工【出生日期】的日期；</p><p>五、Excel中：查找函数，共有18个；<br>ROW函数：&#x3D;ROW（B2）<br>ROW函数，用于返回单元格的行号；选中G2单元格，在编辑栏输入函数公式：&#x3D;ROW（）；然后输入 函数参数：用鼠标选中B2单元格，并按回车键结束确认，即可返回B2单元格的行号：2；</p><p>COLUMN函数：&#x3D;COLUMN（B2）<br>COLUMN函数，用于返回单元格的列号；选中G2单元格，在编辑栏输入函数公式：&#x3D;COLUMN（）；然 后输入函数参数：用鼠标选中B2单元格，并按回车键结束确认，即可返回B2单元格的列号：2；</p><p>VLOOKUP函数：&#x3D;VLOOKUP（H2，B：F，5，0）；<br>VLOOKUP函数，可以在表格区域内，查找指定内容；通过【姓名】列的：貂蝉，可以定位到相关【 学历】列的：高中；</p><p>六、Excel中：信息函数，共有20个；<br>ISBLANK函数：&#x3D;ISBLANK（B4）；<br>ISBLANK函数，用于判断指定的单元格是否为空；如果【姓名】列为空，ISBLANK函数会返回： TRUE；否则会返回：FALSE；</p><p>七、Excel中：WEB函数，共有3个；<br>ENCODEURL函数：&#x3D;ENCODEURL（A2）；<br>ENCODEURL函数，用于返回 URL 编码的字符串，替换为百分比符号 (%) 和十六进制数字形式；</p><p>八、Excel中：三角函数，共有80个；<br>SIN函数：&#x3D;SIN（A2*PI（）&#x2F;180）；<br>SIN函数，即正弦函数，三角函数的一种；用于计算一个角度的正弦值；</p><p>九、Excel中：财务函数，共有55个；<br>RATE函数：&#x3D;RATE（B1，-B2，B3）;<br>RATE为利率函数，假定借款10万元，约定每季度还款1.2万元，共计3年还清，使用RATE函数，可 以计算出年利率为：24.44%；</p><p>十、Excel中：工程函数，共有52个；<br>BIN2DEC函数：&#x3D;BIN2DEC（A2）;<br>BIN2DEC函数，可以将二进制转换成十进制；利用BIN2DEC函数，可以将二进制10，100，1000；转 换成十进制：2，4，8；</p><p>十一、Excel中：兼容函数，共有39个；<br>RANK函数：&#x3D;RANK（E2，$E$2，$E$9）;<br>RANK函数；用于返回指定单元格值的排名，我们选中F2：F9单元格区域，并输入RANK函数公式， 然后按Excel快捷键【Ctrl+Enter】，即可返回月薪排名；</p><p>十二、Excel中：多维函数，共有5个；<br>SUMPRODUCT函数：&#x3D;SUMPRODUCT（A2：B4，C2：D4）;<br>利用SUMPRODUCT函数，可以计算出：A2：B4单元格区域，与C2：D4单元格区域的乘积总和；</p><p>十三、Excel中：数据库函数，共有12个；<br>DSUM函数：&#x3D;DSUM（A1：E9，”销量”，G1：G2）;<br>我们先选中H2单元格，并在编辑栏输入函数公式：&#x3D;DSUM（）；然后输入函数第1个参数：用鼠标 选中A1：E9单元格区域；第2个参数：“销量”；第3个参数：用鼠标选中G1：G2单元格区域；最 后按回车键结束确认，即可计算出：魏国所有销售人员的销量；</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Excel库对比</title>
      <link href="/6f2943a0f333/"/>
      <url>/6f2943a0f333/</url>
      
        <content type="html"><![CDATA[<p>Excel库对应的各种版本<span id="more"></span></p><table><thead><tr><th align="left"></th><th align="center">WIN</th><th align="center">MAC</th><th align="center">PY2</th><th align="center">PY3</th><th align="center">.xls</th><th align="center">.xlsx</th><th align="center">读</th><th align="center">写</th><th align="center">修改</th></tr></thead><tbody><tr><td align="left">xlrd</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">×</td><td align="center">×</td></tr><tr><td align="left">xlwt</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">×</td><td align="center">×</td><td align="center">√</td><td align="center">√</td></tr><tr><td align="left">xlutils</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">×</td><td align="center">×</td><td align="center">×</td><td align="center">√</td></tr><tr><td align="left">xlwings</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td></tr><tr><td align="left">openpyxl</td><td align="center">√</td><td align="center">×</td><td align="center">√</td><td align="center">√</td><td align="center">×</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td></tr><tr><td align="left">xlswriter</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">×</td><td align="center">√</td><td align="center">×</td><td align="center">√</td><td align="center">×</td></tr><tr><td align="left">win32com</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td></tr><tr><td align="left">DataNitro</td><td align="center">√</td><td align="center">×</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="left">pandas</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">√</td><td align="center">×</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Excel快捷键</title>
      <link href="/5ce07f64fbc7/"/>
      <url>/5ce07f64fbc7/</url>
      
        <content type="html"><![CDATA[<p>在Excel中合理的使用快捷键会更好的提高工作效率</p><span id="more"></span><table><thead><tr><th align="left">快捷键</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">Ctrl+N</td><td align="left">新建工作簿</td></tr><tr><td align="left">Ctrl+O</td><td align="left">打开文档</td></tr><tr><td align="left">Ctrl+W</td><td align="left">关闭文档</td></tr><tr><td align="left">Ctrl+A</td><td align="left">全选</td></tr><tr><td align="left">Ctrl+C</td><td align="left">复制</td></tr><tr><td align="left">Ctrl+X</td><td align="left">剪切</td></tr><tr><td align="left">Ctrl+V</td><td align="left">粘贴</td></tr><tr><td align="left">Ctrl+F</td><td align="left">查找</td></tr><tr><td align="left">Ctrl+H</td><td align="left">替换</td></tr><tr><td align="left">Ctrl+P</td><td align="left">打印</td></tr><tr><td align="left">Ctrl+Z</td><td align="left">撤销</td></tr><tr><td align="left">Ctrl+Y</td><td align="left">恢复</td></tr><tr><td align="left">Ctrl+E</td><td align="left">快速填充</td></tr><tr><td align="left">Ctrl+D</td><td align="left">向下填充</td></tr><tr><td align="left">Ctrl+R</td><td align="left">向右填充</td></tr><tr><td align="left">Ctrl+T</td><td align="left">创建“超级表”</td></tr><tr><td align="left">Ctrl+G</td><td align="left">定位</td></tr><tr><td align="left">Ctrl+B</td><td align="left">应用或取消字体加粗格式</td></tr><tr><td align="left">Ctrl+I</td><td align="left">应用或取消字体倾斜格式</td></tr><tr><td align="left">Ctrl+U</td><td align="left">应用或取消底线格式</td></tr><tr><td align="left">Ctrl+K</td><td align="left">调出[插入超链接]对话框</td></tr><tr><td align="left">Ctrl+1</td><td align="left">调出[设置单元格格式]对话框</td></tr><tr><td align="left">Ctrl+F1</td><td align="left">折叠功能区&#x2F;显示完整功能区</td></tr><tr><td align="left">Ctrl+F3</td><td align="left">定义名称</td></tr><tr><td align="left">Ctrl+F9</td><td align="left">最小化窗口</td></tr><tr><td align="left">Ctrl+F10</td><td align="left">最大化窗口</td></tr><tr><td align="left">Shift+F2</td><td align="left">单元格添加批注&#x2F;编辑批注</td></tr><tr><td align="left">Alt+Enter</td><td align="left">强制换行</td></tr><tr><td align="left">Alt+&#x3D;</td><td align="left">一键求和</td></tr><tr><td align="left">Alt+；</td><td align="left">选中当前可见单元格区域</td></tr><tr><td align="left">Ctrl+;</td><td align="left">显示当前日期</td></tr><tr><td align="left">Ctrl+Shift+;</td><td align="left">显示当前时间</td></tr><tr><td align="left">Ctrl+Shift+9</td><td align="left">取消隐藏行</td></tr><tr><td align="left">Ctrl+Shift+0</td><td align="left">取消隐藏列</td></tr><tr><td align="left">Ctrl+Shift+~</td><td align="left">应用“常规”数字格式</td></tr><tr><td align="left">Ctrl+Shift+&amp;</td><td align="left">应用外边框</td></tr><tr><td align="left">Delete</td><td align="left">清除单元格内容</td></tr><tr><td align="left">F4</td><td align="left">重复上一步操作</td></tr><tr><td align="left">F4</td><td align="left">函数三种引用方式</td></tr><tr><td align="left">F5</td><td align="left">定位</td></tr><tr><td align="left">F9</td><td align="left">刷新</td></tr><tr><td align="left">F11</td><td align="left">创建图表</td></tr><tr><td align="left">Ctrl+S</td><td align="left">保存</td></tr><tr><td align="left">F12</td><td align="left">另存为</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python常用单词表</title>
      <link href="/9a43b501e406/"/>
      <url>/9a43b501e406/</url>
      
        <content type="html"><![CDATA[<p>学习python必须背的常见单词</p><span id="more"></span><table><thead><tr><th align="left">函数</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">一、交互式环境与print输出</td><td align="left"></td></tr><tr><td align="left">1、print：</td><td align="left">打印&#x2F;输出</td></tr><tr><td align="left">2、coding：</td><td align="left">编码</td></tr><tr><td align="left">3、syntax：</td><td align="left">语法</td></tr><tr><td align="left">4、error：</td><td align="left">错误</td></tr><tr><td align="left">5、invalid：</td><td align="left">无效</td></tr><tr><td align="left">6、identifier：</td><td align="left">名称&#x2F;标识符</td></tr><tr><td align="left">7、character ：</td><td align="left">字符</td></tr><tr><td align="left">二、字符串的操作</td><td align="left"></td></tr><tr><td align="left">1、user：</td><td align="left">用户</td></tr><tr><td align="left">2、name：</td><td align="left">姓名&#x2F;名称</td></tr><tr><td align="left">3、attribute：</td><td align="left">字段&#x2F;属性</td></tr><tr><td align="left">4、value：</td><td align="left">值</td></tr><tr><td align="left">5、key：</td><td align="left">键</td></tr><tr><td align="left">三、重复&#x2F;转换&#x2F;替换&#x2F;原始字符串</td><td align="left"></td></tr><tr><td align="left">1、upper：</td><td align="left">上面</td></tr><tr><td align="left">2、lower：</td><td align="left">下面</td></tr><tr><td align="left">3、capitalize：</td><td align="left">用大写字母写或印刷</td></tr><tr><td align="left">4、title：</td><td align="left">标题</td></tr><tr><td align="left">5、replace：</td><td align="left">替换</td></tr><tr><td align="left">6、old：</td><td align="left">旧的</td></tr><tr><td align="left">7、new：</td><td align="left">新的</td></tr><tr><td align="left">8、count：</td><td align="left">计数</td></tr><tr><td align="left">9、swap：</td><td align="left">互换</td></tr><tr><td align="left">10、case：</td><td align="left">情形</td></tr><tr><td align="left">11、path：</td><td align="left">路径</td></tr><tr><td align="left">12、new：</td><td align="left">新的\新建</td></tr><tr><td align="left">13、project：</td><td align="left">项目</td></tr><tr><td align="left">14、test：</td><td align="left">测试</td></tr><tr><td align="left">15、file：</td><td align="left">文件</td></tr><tr><td align="left">16、data：</td><td align="left">数据</td></tr><tr><td align="left">四、去除&#x2F;查询&#x2F;计数</td><td align="left"></td></tr><tr><td align="left">1、strip：</td><td align="left">去除</td></tr><tr><td align="left">2、index：</td><td align="left">索引</td></tr><tr><td align="left">3、find：</td><td align="left">查找</td></tr><tr><td align="left">4、count：</td><td align="left">计数</td></tr><tr><td align="left">5、start：</td><td align="left">开始</td></tr><tr><td align="left">6、end：</td><td align="left">结束</td></tr><tr><td align="left">7、chars：</td><td align="left">字符</td></tr><tr><td align="left">8、sub：</td><td align="left">附属</td></tr><tr><td align="left">五、获取输入&#x2F;格式化</td><td align="left"></td></tr><tr><td align="left">1、input：</td><td align="left">输入</td></tr><tr><td align="left">2、prompt：</td><td align="left">提示</td></tr><tr><td align="left">3、ID：</td><td align="left">身份证</td></tr><tr><td align="left">4、format：</td><td align="left">格式化</td></tr><tr><td align="left">5、args（argument）：</td><td align="left">参数</td></tr><tr><td align="left">6、kwargs：</td><td align="left">关键字参数</td></tr><tr><td align="left">7、year：</td><td align="left">年</td></tr><tr><td align="left">8、month：</td><td align="left">月</td></tr><tr><td align="left">9、day：</td><td align="left">日</td></tr><tr><td align="left">六、元组</td><td align="left"></td></tr><tr><td align="left">1、tuple：</td><td align="left">元组</td></tr><tr><td align="left">2、max：</td><td align="left">最大</td></tr><tr><td align="left">3、min：</td><td align="left">最小</td></tr><tr><td align="left">4、iterable：</td><td align="left">可迭代</td></tr><tr><td align="left">5、key：</td><td align="left">关键字</td></tr><tr><td align="left">6、function：</td><td align="left">方法&#x2F;函数</td></tr><tr><td align="left">7、stop：</td><td align="left">停止</td></tr><tr><td align="left">8、object：</td><td align="left">对象</td></tr><tr><td align="left">七、列表</td><td align="left"></td></tr><tr><td align="left">1、list：</td><td align="left">列表</td></tr><tr><td align="left">2、reverse：</td><td align="left">反向</td></tr><tr><td align="left">3、true：</td><td align="left">真</td></tr><tr><td align="left">4、false：</td><td align="left">假</td></tr><tr><td align="left">5、append：</td><td align="left">附加</td></tr><tr><td align="left">6、extend：</td><td align="left">扩展</td></tr><tr><td align="left">7、insert：</td><td align="left">插入</td></tr><tr><td align="left">8、pop：</td><td align="left">取出</td></tr><tr><td align="left">9、remove：</td><td align="left">移除</td></tr><tr><td align="left">10、del（delete）：</td><td align="left">删除</td></tr><tr><td align="left">11、clear：</td><td align="left">清除</td></tr><tr><td align="left">12、sort：</td><td align="left">排序</td></tr><tr><td align="left">八、集合</td><td align="left"></td></tr><tr><td align="left">1、set：</td><td align="left">集合&#x2F;设置</td></tr><tr><td align="left">2、add：</td><td align="left">添加</td></tr><tr><td align="left">3、update：</td><td align="left">更新</td></tr><tr><td align="left">4、discard：</td><td align="left">丢弃</td></tr><tr><td align="left">5、intersection：</td><td align="left">相交</td></tr><tr><td align="left">6、union：</td><td align="left">联合</td></tr><tr><td align="left">7、difference：</td><td align="left">差数</td></tr><tr><td align="left">8、symmetric：</td><td align="left">对称</td></tr><tr><td align="left">9、in：</td><td align="left">在…里面</td></tr><tr><td align="left">10、not：</td><td align="left">不&#x2F;不是</td></tr><tr><td align="left">11、disjoint：</td><td align="left">不相交</td></tr><tr><td align="left">12、subset：</td><td align="left">子集</td></tr><tr><td align="left">13、superset：</td><td align="left">父集&#x2F;超集</td></tr><tr><td align="left">14、copy：</td><td align="left">复制</td></tr><tr><td align="left">九、字典</td><td align="left"></td></tr><tr><td align="left">1、dict：</td><td align="left">字典</td></tr><tr><td align="left">2、key：</td><td align="left">键&#x2F;关键字</td></tr><tr><td align="left">3、value：</td><td align="left">值</td></tr><tr><td align="left">4、item：</td><td align="left">项</td></tr><tr><td align="left">5、mapping：</td><td align="left">映射</td></tr><tr><td align="left">6、seq（sequence）：</td><td align="left">序列</td></tr><tr><td align="left">7、from：</td><td align="left">从&#x2F;来自</td></tr><tr><td align="left">8、get：</td><td align="left">获取</td></tr><tr><td align="left">9、default：</td><td align="left">默认</td></tr><tr><td align="left">10、none：</td><td align="left">没有</td></tr><tr><td align="left">11、arg：</td><td align="left">可变元素</td></tr><tr><td align="left">12、kwargs（keyword args）：</td><td align="left">可变关键字元素</td></tr><tr><td align="left">十、循环</td><td align="left"></td></tr><tr><td align="left">1、for…in…</td><td align="left">循环的使用</td></tr><tr><td align="left">2、while…</td><td align="left">循环的使用</td></tr><tr><td align="left">3、range：</td><td align="left">范围</td></tr><tr><td align="left">4、sep(separate)：</td><td align="left">分隔</td></tr><tr><td align="left">5、flush：</td><td align="left">冲刷</td></tr><tr><td align="left">6、step：</td><td align="left">步长</td></tr><tr><td align="left">7、continue：</td><td align="left">继续</td></tr><tr><td align="left">8、break：</td><td align="left">突破&#x2F;跳出</td></tr><tr><td align="left">十一、条件&#x2F;跳出与结束循环</td><td align="left"></td></tr><tr><td align="left">1、if：</td><td align="left">如果</td></tr><tr><td align="left">2、else：</td><td align="left">否则</td></tr><tr><td align="left">十二、运算符与随机数</td><td align="left"></td></tr><tr><td align="left">1、module：</td><td align="left">模块</td></tr><tr><td align="left">2、sys(system)：</td><td align="left">系统</td></tr><tr><td align="left">3、path：</td><td align="left">路径</td></tr><tr><td align="left">4、import：</td><td align="left">导入</td></tr><tr><td align="left">5、from：</td><td align="left">从…</td></tr><tr><td align="left">十三、定义函数与设定参数</td><td align="left"></td></tr><tr><td align="left">1、birthday：</td><td align="left">出生日期</td></tr><tr><td align="left">2、year：</td><td align="left">年份</td></tr><tr><td align="left">3、month：</td><td align="left">月份</td></tr><tr><td align="left">4、day：</td><td align="left">日期</td></tr><tr><td align="left">5、type：</td><td align="left">类型</td></tr><tr><td align="left">6、error：</td><td align="left">错误</td></tr><tr><td align="left">7、missing：</td><td align="left">丢失</td></tr><tr><td align="left">8、required：</td><td align="left">必须</td></tr><tr><td align="left">9、positional：</td><td align="left">位置</td></tr><tr><td align="left">10、unsupported：</td><td align="left">不支持</td></tr><tr><td align="left">十四、设定收集参数</td><td align="left"></td></tr><tr><td align="left">1、create：</td><td align="left">创建</td></tr><tr><td align="left">2、info：</td><td align="left">信息</td></tr><tr><td align="left">3、age：</td><td align="left">年龄</td></tr><tr><td align="left">4、height：</td><td align="left">高度</td></tr><tr><td align="left">5、width：</td><td align="left">宽度</td></tr><tr><td align="left">6、weight：</td><td align="left">重量</td></tr><tr><td align="left">7、splicing：</td><td align="left">拼接</td></tr><tr><td align="left">8、params：</td><td align="left">参数</td></tr><tr><td align="left">9、volume：</td><td align="left">体积</td></tr><tr><td align="left">11、operand：</td><td align="left">操作数</td></tr><tr><td align="left">十五、嵌套函数&#x2F;作用域&#x2F;闭包</td><td align="left"></td></tr><tr><td align="left">1、inside：</td><td align="left">内部</td></tr><tr><td align="left">2、outside：</td><td align="left">外部</td></tr><tr><td align="left">3、radius：</td><td align="left">半径</td></tr><tr><td align="left">4、perimeter：</td><td align="left">周长</td></tr><tr><td align="left">5、case：</td><td align="left">情形</td></tr><tr><td align="left">6、synthesis：</td><td align="left">合成</td></tr><tr><td align="left">7、execute：</td><td align="left">执行</td></tr><tr><td align="left">十六、递归函数</td><td align="left"></td></tr><tr><td align="left">1、recursion：</td><td align="left">递归</td></tr><tr><td align="left">2、Infinite：</td><td align="left">无穷</td></tr><tr><td align="left">3、maximum：</td><td align="left">最大值</td></tr><tr><td align="left">4、depth：</td><td align="left">深度</td></tr><tr><td align="left">5、exceeded：</td><td align="left">超过</td></tr><tr><td align="left">6、factorial：</td><td align="left">阶乘</td></tr><tr><td align="left">7、search：</td><td align="left">查询</td></tr><tr><td align="left">8、power：</td><td align="left">幂</td></tr><tr><td align="left">9、lower：</td><td align="left">下方</td></tr><tr><td align="left">10、upper：</td><td align="left">上方</td></tr><tr><td align="left">11、middle：</td><td align="left">中间</td></tr><tr><td align="left">12、assert&#x2F;assertion：</td><td align="left">异常</td></tr><tr><td align="left">十七、列表推导式&#x2F;lambda表达式</td><td align="left"></td></tr><tr><td align="left">1、square：</td><td align="left">平方</td></tr><tr><td align="left">2、even：</td><td align="left">偶数</td></tr><tr><td align="left">3、comprehension：</td><td align="left">理解</td></tr><tr><td align="left">4、lambda：</td><td align="left">希腊字母λ的英文名称</td></tr><tr><td align="left">十八、列表推导式&#x2F;lambda表达式</td><td align="left"></td></tr><tr><td align="left">1、regular：</td><td align="left">规则</td></tr><tr><td align="left">2、expression：</td><td align="left">表达式</td></tr><tr><td align="left">3、group：</td><td align="left">组</td></tr><tr><td align="left">4、match：</td><td align="left">匹配</td></tr><tr><td align="left">5、span：</td><td align="left">跨度</td></tr><tr><td align="left">6、ignore case：</td><td align="left">忽略 大小写</td></tr><tr><td align="left">7、multi line：</td><td align="left">多 行</td></tr><tr><td align="left">8、dot all：</td><td align="left">点 全部</td></tr><tr><td align="left">9、unicode：</td><td align="left">万国码</td></tr><tr><td align="left">10、verbose：</td><td align="left">累赘</td></tr><tr><td align="left">11、pos&#x2F;position：</td><td align="left">位置</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python爬取豆瓣电影排行榜</title>
      <link href="/f674d839297d/"/>
      <url>/f674d839297d/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">#1-爬取数据&lt;!--more--&gt;</span><br><span class="line">url = &#x27;https://movie.douban.com/chart&#x27;</span><br><span class="line">headers = &#123;&#x27;User-Agent&#x27;:&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36&#x27;&#125;</span><br><span class="line">response = requests.get(url,headers = headers)</span><br><span class="line">#print(response.text)</span><br><span class="line">html_str = response.text</span><br><span class="line"></span><br><span class="line">#2-解析数据</span><br><span class="line">patten = re.compile(&#x27;&lt; a.*?nbg.*?title=&quot;(.*?)&quot;&gt;&#x27;,re.S)</span><br><span class="line">items = re.findall(patten,html_str)</span><br><span class="line">print(items)</span><br><span class="line"></span><br><span class="line">#3-存储数据</span><br><span class="line">with open(&#x27;douban.txt&#x27;,&quot;w&quot;,encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">+ for item in items:</span><br><span class="line">- f.write(item+&#x27;\n&#x27;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xlsxwriter新建Excel表格</title>
      <link href="/8488faa216c0/"/>
      <url>/8488faa216c0/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">import xlsxwriter</span><br><span class="line"></span><br><span class="line">#新建excel表</span><br><span class="line">workbook = xlsxwriter.Workbook(&#x27;D:/hello.xlsx&#x27;)</span><br><span class="line">&lt;!--more--&gt;</span><br><span class="line"></span><br><span class="line">#新建sheet（sheet的名称为&quot;sheet1&quot;）</span><br><span class="line">worksheet = workbook.add_worksheet()</span><br><span class="line"></span><br><span class="line">#定义表头内容</span><br><span class="line">Title = [&#x27;实例ID&#x27;, &#x27;实例配置&#x27;, &#x27;实例名&#x27;, &#x27;地域&#x27;, &#x27;安全组&#x27;, &#x27;EIP&#x27;]</span><br><span class="line"></span><br><span class="line">#定义标题格式</span><br><span class="line">merge_format = workbook.add_format(&#123;</span><br><span class="line">+ &#x27;bold&#x27;: True,</span><br><span class="line">+ &#x27;border&#x27;: 1,</span><br><span class="line">+ &#x27;align&#x27;: &#x27;center&#x27;,</span><br><span class="line">+ &#x27;valign&#x27;: &#x27;vcenter&#x27;,</span><br><span class="line">+ &#x27;fg_color&#x27;: &#x27;#E0FFFF&#x27;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">#定义表头格式</span><br><span class="line">title_format = workbook.add_format(&#123;</span><br><span class="line">+ &#x27;bold&#x27;: True,</span><br><span class="line">+ &#x27;border&#x27;: 1,</span><br><span class="line">+ &#x27;align&#x27;: &#x27;center&#x27;,</span><br><span class="line">+ &#x27;valign&#x27;: &#x27;vcenter&#x27;,</span><br><span class="line">+ &#x27;fg_color&#x27;: &#x27;#87CEFF&#x27;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">#定义内容格式</span><br><span class="line">data_format = workbook.add_format(&#123;</span><br><span class="line">+ &#x27;border&#x27;: 1,</span><br><span class="line">+ &#x27;align&#x27;: &#x27;center&#x27;,</span><br><span class="line">+ &#x27;valign&#x27;: &#x27;vcenter&#x27;,</span><br><span class="line">+ &#x27;fg_color&#x27;: &#x27;#EED8AE&#x27;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">#拟数据</span><br><span class="line">data = [[&#x27;i-1&#x27;, &#x27;1C1G&#x27;, &#x27;demo1&#x27;, &#x27;上海&#x27;, &#x27;sg-1&#x27;, &#x27;172.20.2.10&#x27;],</span><br><span class="line">+ [&#x27;i-2&#x27;, &#x27;1C1G&#x27;, &#x27;demo2&#x27;, &#x27;郑州&#x27;, &#x27;sg-2&#x27;, &#x27;172.20.2.11&#x27;],</span><br><span class="line">+ [&#x27;i-3&#x27;, &#x27;1C1G&#x27;, &#x27;demo3&#x27;, &#x27;北京&#x27;, &#x27;sg-3&#x27;, &#x27;172.20.2.12&#x27;]]</span><br><span class="line"></span><br><span class="line">#合并 A1 - F1 单元格作为标题，传入参数：1：合并单元格，2：标题文字，3：标题格式</span><br><span class="line">worksheet.merge_range(&#x27;A1:F1&#x27;, &#x27;ECS信息表&#x27;, merge_format)</span><br><span class="line"></span><br><span class="line">#设置列宽，指定 A - F 的列宽为 25</span><br><span class="line">worksheet.set_column(&#x27;A:F&#x27;, 25)</span><br><span class="line"></span><br><span class="line">#设置行号，指定行数，高度，A1 为 0，A2 为 1，以此类推</span><br><span class="line">worksheet.set_row(0, 60)</span><br><span class="line"></span><br><span class="line">#write_row ，写行，传入参数：1：行，2：内容，3：格式</span><br><span class="line">worksheet.write_row(&#x27;A2&#x27;, Title, title_format)</span><br><span class="line">i = 3</span><br><span class="line">for ECS in data:</span><br><span class="line">+ worksheet.write_row(&#x27;A&#x27; + str(i), ECS, data_format)</span><br><span class="line">+ i += 1</span><br><span class="line"></span><br><span class="line">#将excel文件保存关闭，如果没有这一行运行代码会报错</span><br><span class="line">workbook.close()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用xlwt库将数据写入excel</title>
      <link href="/5acc25f815ef/"/>
      <url>/5acc25f815ef/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import xlwt</span><br><span class="line">#1. 创建workbook对象</span><br><span class="line">workbook = xlwt.Workbook(encoding=&quot;utf-8&quot;)</span><br><span class="line">#2. 增加一个sheet # 设置成可以覆盖原先内容</span><br><span class="line">worksheet = workbook.add_sheet(&quot;sheet1&quot;, cell_overwrite_ok=True)</span><br><span class="line">#3. 在单元格中添加内容，第一个参数为行，第二个参数为列，第三个参数为内容</span><br><span class="line">worksheet.write(0,0, &quot;hello&quot;)</span><br><span class="line">#4. 保存数据表</span><br><span class="line">workbook.save(&quot;./student.xls&quot;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>保留表头拆分数据为若干新工作簿</title>
      <link href="/f824c6539974/"/>
      <url>/f824c6539974/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Sub 保留表头拆分数据为若干新工作簿()</span><br><span class="line">Dim arr, d As Object, k, t, i&amp;, lc%, rng As Range, c%</span><br><span class="line">c = Application.InputBox(&quot;请输入拆分列号&quot;, , 4, , , , , 1)</span><br><span class="line"></span><br><span class="line">If c = 0 Then Exit Sub</span><br><span class="line">Application.ScreenUpdating = False</span><br><span class="line">Application.DisplayAlerts = False</span><br><span class="line">arr = [a1].CurrentRegion</span><br><span class="line">lc = UBound(arr, 2)</span><br><span class="line">Set rng = [a1].Resize(, lc)</span><br><span class="line">Set d = CreateObject(&quot;scripting.dictionary&quot;)</span><br><span class="line">For i = 2 To UBound(arr)</span><br><span class="line">If Not d.Exists(arr(i, c)) Then</span><br><span class="line">Set d(arr(i, c)) = Cells(i, 1).Resize(1, lc)</span><br><span class="line">Else</span><br><span class="line">Set d(arr(i, c)) = Union(d(arr(i, c)), Cells(i, 1).Resize(1, lc))</span><br><span class="line">End If</span><br><span class="line">Next</span><br><span class="line">k = d.Keys</span><br><span class="line">t = d.Items</span><br><span class="line">For i = 0 To d.Count - 1</span><br><span class="line">With Workbooks.Add(xlWBATWorksheet)</span><br><span class="line">rng.Copy .Sheets(1).[a1]</span><br><span class="line">t(i).Copy .Sheets(1).[a2]</span><br><span class="line">.SaveAs Filename:=ThisWorkbook.Path &amp; &quot;\&quot; &amp; k(i) &amp; &quot;.xls&quot;</span><br><span class="line">.Close</span><br><span class="line">End With</span><br><span class="line">Next</span><br><span class="line">Application.DisplayAlerts = True</span><br><span class="line">Application.ScreenUpdating = True</span><br><span class="line">MsgBox &quot;完毕&quot;</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>合并当前目录下所有工作簿的全部工作表</title>
      <link href="/acd720a15c0a/"/>
      <url>/acd720a15c0a/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Sub 合并当前目录下所有工作簿的全部工作表()</span><br><span class="line">Dim MyPath, MyName, AWbName</span><br><span class="line">Dim Wb As Workbook, WbN As String</span><br><span class="line">Dim G As Long</span><br><span class="line"></span><br><span class="line">Dim Num As Long</span><br><span class="line">Dim BOX As String</span><br><span class="line">Application.ScreenUpdating = False</span><br><span class="line">MyPath = ActiveWorkbook.Path</span><br><span class="line">MyName = Dir(MyPath &amp; &quot;\&quot; &amp; &quot;*.csv&quot;)</span><br><span class="line">AWbName = ActiveWorkbook.Name</span><br><span class="line">Num = 0</span><br><span class="line">Do While MyName &lt;&gt; &quot;&quot;</span><br><span class="line">If MyName &lt;&gt; AWbName Then</span><br><span class="line">Set Wb = Workbooks.Open(MyPath &amp; &quot;\&quot; &amp; MyName)</span><br><span class="line">Num = Num + 1</span><br><span class="line">With Workbooks(1).ActiveSheet</span><br><span class="line">.Cells(.Range(&quot;B65536&quot;).End(xlUp).Row + 2, 1) = Left(MyName, Len(MyName) - 4)</span><br><span class="line">For G = 1 To Sheets.Count</span><br><span class="line">Wb.Sheets(G).UsedRange.Copy .Cells(.Range(&quot;B65536&quot;).End(xlUp).Row + 1, 1)</span><br><span class="line">Next</span><br><span class="line">WbN = WbN &amp; Chr(13) &amp; Wb.Name</span><br><span class="line">Wb.Close False</span><br><span class="line">End With</span><br><span class="line">End If</span><br><span class="line">MyName = Dir</span><br><span class="line">Loop</span><br><span class="line">Range(&quot;B1&quot;).Select</span><br><span class="line">Application.ScreenUpdating = True</span><br><span class="line">MsgBox &quot;共合并了&quot; &amp; Num &amp; &quot;个工作薄下的全部工作表。如下：&quot; &amp; Chr(13) &amp; WbN, vbInformation, &quot;提示&quot;</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>合并文件夹下工作薄</title>
      <link href="/f9b2d831be09/"/>
      <url>/f9b2d831be09/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path = r&#x27;地址&#x27;&lt;!--more--&gt;</span><br><span class="line">file_list = []</span><br><span class="line"></span><br><span class="line">dfs = []</span><br><span class="line"></span><br><span class="line">for root,dirs,files in os.walk(path):</span><br><span class="line">for file in files:</span><br><span class="line">file_path = os.path.join(root, file)</span><br><span class="line">file_list.append(file_path)</span><br><span class="line">df = pd.read_csv(file_path,encoding=&quot;gbk&quot;)</span><br><span class="line">dfs.append(df)</span><br><span class="line">df = pd.concat(dfs)</span><br><span class="line">df.to_excel(r&#x27;地址\汇总.xls&#x27;, index=False)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字符串前缀含义</title>
      <link href="/807efc31e74a/"/>
      <url>/807efc31e74a/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th align="left">转义符</th><th align="left">释义</th></tr></thead><tbody><tr><td align="left">r</td><td align="left">去除转义字符</td></tr><tr><td align="left">b</td><td align="left">该字符串是bytes 类型</td></tr><tr><td align="left">u</td><td align="left">该字符串以Unicode 格式进行编码</td></tr><tr><td align="left">f</td><td align="left">在字符串内支持大括号内的表达式</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>将工作薄按列拆分至工作薄</title>
      <link href="/ba7ce021b3b8/"/>
      <url>/ba7ce021b3b8/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">data = pd.read_excel(r&#x27;地址\汇总.xls&#x27;,keep_default_na=False)</span><br><span class="line">unit_list = list(data[&#x27;姓名&#x27;].drop_duplicates())</span><br><span class="line">for i in unit_list:</span><br><span class="line">data_new = data[data[&#x27;姓名&#x27;] == i]</span><br><span class="line">if i == &#x27;&#x27;:</span><br><span class="line">data_new.to_excel()</span><br><span class="line">else:</span><br><span class="line">data_new.to_excel(r&quot;地址\%s.xls&quot; % (i),index=False)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>将工作薄按列拆分至工作表</title>
      <link href="/fc53ed98d358/"/>
      <url>/fc53ed98d358/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">data=pd.read_excel(r&quot;地址\汇总.xls&quot;)</span><br><span class="line">xlsx = pd.ExcelWriter(r&quot;地址\汇总-拆分完成.xlsx&quot;)</span><br><span class="line"></span><br><span class="line">for i in data[&quot;姓名&quot;].unique():</span><br><span class="line">data[data[&quot;姓名&quot;]==i].to_excel(xlsx,sheet_name=i,index=False)</span><br><span class="line"></span><br><span class="line">xlsx.close()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用内置函数</title>
      <link href="/b7ac2e53b21d/"/>
      <url>/b7ac2e53b21d/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th align="left">函数</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">print()</td><td align="left">打印输出</td></tr><tr><td align="left">input()</td><td align="left">获取用户输出的内容</td></tr><tr><td align="left">open()</td><td align="left">用于打开一个文件,创建一个文件句柄</td></tr><tr><td align="left">list()</td><td align="left">将一个可迭代对象转换成列表</td></tr><tr><td align="left">tuple()</td><td align="left">将一个可迭代对象转换成元组</td></tr><tr><td align="left">reversed()</td><td align="left">将一个序列翻转,返回翻转序列的迭代器</td></tr><tr><td align="left">range()</td><td align="left">生成数据</td></tr><tr><td align="left">str()</td><td align="left">将数据转化成字符串</td></tr><tr><td align="left">all()</td><td align="left">可迭代对象中全部是True,结果才是True</td></tr><tr><td align="left">any()</td><td align="left">可迭代对象中有一个是True,结果就是True</td></tr><tr><td align="left">eval()</td><td align="left">执行字符串类型的代码,并返回最终结果</td></tr><tr><td align="left">dir()</td><td align="left">查看对象的内置属性,访问的是对象中的__dir__()方法</td></tr><tr><td align="left">help()</td><td align="left">函数用于查看函数或模块用途的详细说明</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用运算符</title>
      <link href="/967e1202e9a8/"/>
      <url>/967e1202e9a8/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th align="left">运算符</th><th align="left">作用</th></tr></thead><tbody><tr><td align="left">+、-、*、&#x2F;</td><td align="left">加减乘除</td></tr><tr><td align="left">%</td><td align="left">取余</td></tr><tr><td align="left">&#x2F;&#x2F;</td><td align="left">取整</td></tr><tr><td align="left">**</td><td align="left">幂（常用x**y或pow(x,y)表示）</td></tr><tr><td align="left">&amp;</td><td align="left">位运算符中的位与</td></tr><tr><td align="left">|</td><td align="left">位运算符中的位或</td></tr><tr><td align="left">^</td><td align="left">位运算符中的位异或</td></tr><tr><td align="left">~</td><td align="left">位运算符中的取反</td></tr><tr><td align="left">abs(x)</td><td align="left">取绝对值</td></tr><tr><td align="left">int(x)</td><td align="left">转为整数</td></tr><tr><td align="left">float(x)</td><td align="left">转为浮点数</td></tr><tr><td align="left">complex(re,im)</td><td align="left">将参数转化为复数,re为复数的实部,im为复数的虚部</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>把汉字转换成拼音首字母</title>
      <link href="/01f593f543c5/"/>
      <url>/01f593f543c5/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Function pinyin(p As String) As String</span><br><span class="line">i = Asc(p)</span><br><span class="line">Select Case i</span><br><span class="line">Case -20319 To -20284: pinyin = &quot;A&quot;</span><br><span class="line">Case -20283 To -19776: pinyin = &quot;B&quot;</span><br><span class="line">Case -19775 To -19219: pinyin = &quot;C&quot;</span><br><span class="line">Case -19218 To -18711: pinyin = &quot;D&quot;</span><br><span class="line">Case -18710 To -18527: pinyin = &quot;E&quot;</span><br><span class="line">Case -18526 To -18240: pinyin = &quot;F&quot;</span><br><span class="line">Case -18239 To -17923: pinyin = &quot;G&quot;</span><br><span class="line">Case -17922 To -17418: pinyin = &quot;H&quot;</span><br><span class="line">Case -17417 To -16475: pinyin = &quot;J&quot;</span><br><span class="line">Case -16474 To -16213: pinyin = &quot;K&quot;</span><br><span class="line">Case -16212 To -15641: pinyin = &quot;L&quot;</span><br><span class="line">Case -15640 To -15166: pinyin = &quot;M&quot;</span><br><span class="line">Case -15165 To -14923: pinyin = &quot;N&quot;</span><br><span class="line">Case -14922 To -14915: pinyin = &quot;O&quot;</span><br><span class="line">Case -14914 To -14631: pinyin = &quot;P&quot;</span><br><span class="line">Case -14630 To -14150: pinyin = &quot;Q&quot;</span><br><span class="line">Case -14149 To -14091: pinyin = &quot;R&quot;</span><br><span class="line">Case -14090 To -13319: pinyin = &quot;S&quot;</span><br><span class="line">Case -13318 To -12839: pinyin = &quot;T&quot;</span><br><span class="line">Case -12838 To -12557: pinyin = &quot;W&quot;</span><br><span class="line">Case -12556 To -11848: pinyin = &quot;X&quot;</span><br><span class="line">Case -11847 To -11056: pinyin = &quot;Y&quot;</span><br><span class="line">Case -11055 To -2050: pinyin = &quot;Z&quot;</span><br><span class="line">Case Else: pinyin = p</span><br><span class="line">End Select</span><br><span class="line">End Function</span><br><span class="line">Function getpy(str)</span><br><span class="line">For i = 1 To Len(str)</span><br><span class="line">getpy = getpy &amp; pinyin(Mid(str, i, 1))</span><br><span class="line">Next i</span><br><span class="line">End Function</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在单元格输入公式”&#x3D;getpy()”</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>指定条件单元格计数</title>
      <link href="/7c9d41d76f4b/"/>
      <url>/7c9d41d76f4b/</url>
      
        <content type="html"><![CDATA[<p>&#x3D;COUNTIFS（B2：B9，“男”）<br>“B2：B9”为需要计数的区域<br>“男”，计数条件</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>条件求和</title>
      <link href="/d89ef85a5399/"/>
      <url>/d89ef85a5399/</url>
      
        <content type="html"><![CDATA[<p>&#x3D;SUMIF(A1:A10,E4,C1:C10)<br>“A1:A10”选择求和项列<br>“E4”选择求和项<br>“C1:C10”选择数值列</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>正则表达式模式</title>
      <link href="/9995cbd56bdf/"/>
      <url>/9995cbd56bdf/</url>
      
        <content type="html"><![CDATA[<p>正则表达式字符释义</p><span id="more"></span><table><thead><tr><th align="left">序号<img width=100></th><th align="left">字符<img width=200></th><th align="left">描述<img width=1000></th></tr></thead><tbody><tr><td align="left">1</td><td align="left">^</td><td align="left">匹配字符串的开头</td></tr><tr><td align="left">2</td><td align="left">$</td><td align="left">匹配字符串的末尾</td></tr><tr><td align="left">3</td><td align="left">.</td><td align="left">4</td></tr><tr><td align="left">5</td><td align="left">[…]</td><td align="left">用来表示一组字符,单独列出：[amk] 匹配 ‘a’，’m’或’k’</td></tr><tr><td align="left">6</td><td align="left">[^…]</td><td align="left">不在[]中的字符：[^abc] 匹配除了a,b,c之外的字符</td></tr><tr><td align="left">7</td><td align="left">re*</td><td align="left">匹配0个或多个的表达式</td></tr><tr><td align="left">8</td><td align="left">re+</td><td align="left">匹配1个或多个的表达式</td></tr><tr><td align="left">9</td><td align="left">re?</td><td align="left">匹配0个或1个由前面的正则表达式定义的片段，非贪婪方式</td></tr><tr><td align="left">10</td><td align="left">re{n}</td><td align="left">精确匹配 n 个前面表达式。例如， o{2} 不能匹配 “Bob” 中的 “o”，但是能匹配 “food” 中的两个 o</td></tr><tr><td align="left">11</td><td align="left">re{n,}</td><td align="left">匹配 n 个前面表达式。例如， o{2,} 不能匹配”Bob”中的”o”，但能匹配 “foooood”中的所有 o。”o{1,}” 等价于 “o+”。”o{0,}” 则等价于 “o*”</td></tr><tr><td align="left">12</td><td align="left">re{n,m}</td><td align="left">匹配 n 到 m 次由前面的正则表达式定义的片段，贪婪方式</td></tr><tr><td align="left">13</td><td align="left">a|b</td><td align="left">匹配a或b</td></tr><tr><td align="left">14</td><td align="left">(re)</td><td align="left">对正则表达式分组并记住匹配的文本</td></tr><tr><td align="left">15</td><td align="left">(?imx)</td><td align="left">正则表达式包含三种可选标志：i, m, 或 x 。只影响括号中的区域</td></tr><tr><td align="left">16</td><td align="left">(?-imx)</td><td align="left">正则表达式关闭 i, m, 或 x 可选标志。只影响括号中的区域</td></tr><tr><td align="left">17</td><td align="left">(?:re)</td><td align="left">类似 (…), 但是不表示一个组</td></tr><tr><td align="left">18</td><td align="left">(?imx:re)</td><td align="left">在括号中使用i, m, 或 x 可选标志</td></tr><tr><td align="left">19</td><td align="left">(?-imx:re)</td><td align="left">在括号中不使用i, m, 或 x 可选标志</td></tr><tr><td align="left">20</td><td align="left">(?#…)</td><td align="left">注释</td></tr><tr><td align="left">21</td><td align="left">(?&#x3D;re)</td><td align="left">前向肯定界定符。如果所含正则表达式，以 … 表示，在当前位置成功匹配时成功，否则失败。但一旦所含表达式已经尝试，匹配引擎根本没有提高；模式的剩余部分还要尝试界定符的右边</td></tr><tr><td align="left">22</td><td align="left">(?!re)</td><td align="left">前向否定界定符。与肯定界定符相反；当所含表达式不能在字符串当前位置匹配时成功</td></tr><tr><td align="left">23</td><td align="left">(?&gt; re)</td><td align="left">匹配的独立模式，省去回溯</td></tr><tr><td align="left">24</td><td align="left">\w</td><td align="left">匹配字母数字及下划线</td></tr><tr><td align="left">25</td><td align="left">\W</td><td align="left">匹配非字母数字及下划线</td></tr><tr><td align="left">26</td><td align="left">\s</td><td align="left">匹配任意空白字符，等价于[ \t\n\r\f]</td></tr><tr><td align="left">27</td><td align="left">\S</td><td align="left">匹配任意非空字符</td></tr><tr><td align="left">28</td><td align="left">\d</td><td align="left">匹配任意数字，等价于 [0-9]</td></tr><tr><td align="left">29</td><td align="left">\D</td><td align="left">匹配任意非数字</td></tr><tr><td align="left">30</td><td align="left">\A</td><td align="left">匹配字符串开始</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬取关键字写入表格</title>
      <link href="/d3065779c9d8/"/>
      <url>/d3065779c9d8/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">import xlwt</span><br><span class="line"></span><br><span class="line">headers = &#123;&#x27;User-Agent&#x27;:&quot;Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0&quot;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">book = xlwt.Workbook()</span><br><span class="line">sheet = book.add_sheet(&#x27;ke_tengxun&#x27;,cell_overwrite_ok=True)</span><br><span class="line"></span><br><span class="line">rownum = 1</span><br><span class="line">def get_info(url):</span><br><span class="line">    global rownum</span><br><span class="line">    res = requests.get(url,headers = headers)</span><br><span class="line">    pattern = re.compile(&#x27;.*?rel=&quot;nofollow&quot;.*?&gt;(.*?)&lt;&#x27;,re.S)</span><br><span class="line">    ke_chupin =re.findall(pattern,res.text)</span><br><span class="line">    pattern = re.compile(&#x27;</span><br><span class="line">.*?cors-name=&quot;course&quot;&gt;(.*?)&lt;&#x27;,re.S)</span><br><span class="line">    ke_name =re.findall(pattern,res.text)</span><br><span class="line">    pattern = re.compile(&#x27;</span><br><span class="line">.*?href=&quot;(.*?)&quot;.*?target&#x27;,re.S)</span><br><span class="line">    ke_href =re.findall(pattern,res.text)</span><br><span class="line">    print(ke_chupin)</span><br><span class="line">    print(len(ke_chupin))</span><br><span class="line">    print(ke_name)</span><br><span class="line">    print(len(ke_name))</span><br><span class="line">    print(ke_href)</span><br><span class="line">    print(len(ke_href))</span><br><span class="line"></span><br><span class="line">    head = [&#x27;课程&#x27;,&#x27;链接&#x27;,&#x27;出品人&#x27;]</span><br><span class="line">    for h in range(len(head)):</span><br><span class="line">        sheet.write(0,h,head[h])</span><br><span class="line">    for l in range(len(ke_name[:24])):</span><br><span class="line">        sheet.write(rownum,0,ke_name[l])</span><br><span class="line">        sheet.write(rownum,1,ke_href[l])</span><br><span class="line">        sheet.write(rownum,2,ke_chupin[l])</span><br><span class="line">        rownum += 1</span><br><span class="line"></span><br><span class="line">    book.save(&#x27;test.xls&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    for i in range(1,13):</span><br><span class="line">        urls = &#x27;https://ke.qq.com/course/list?mt=1001&amp;st=2002&amp;tt=3019&amp;page=&#123;&#125;&#x27;.format(i)</span><br><span class="line">        get_info(urls)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬虫标准框架</title>
      <link href="/c7250efa686b/"/>
      <url>/c7250efa686b/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url=&quot;https://www.sogou.com/web?query=周杰伦&quot;</span><br><span class="line"></span><br><span class="line">headers=&#123; &quot;User-Agent&quot;:&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36 Edg/97.0.1072.55&quot; &#125;</span><br><span class="line">#以字典的形式设置请求头，处理反爬 resp=requests.get(url,headers=headers)</span><br><span class="line">print(resp)</span><br><span class="line">#结果：Response [200]</span><br><span class="line">print(resp.text)</span><br><span class="line">#拿到页面源代码</span><br><span class="line">resp.close()</span><br><span class="line">#关掉resp</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第三方库安装命令</title>
      <link href="/5aad0388be5d/"/>
      <url>/5aad0388be5d/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th align="left">需求</th><th align="left">命令</th></tr></thead><tbody><tr><td align="left">更新pip命令</td><td align="left">python -m pip install –upgrade pip</td></tr><tr><td align="left">下载pandas</td><td align="left">pip install pandas</td></tr><tr><td align="left">下载xlwt</td><td align="left">pip install xlwt</td></tr><tr><td align="left">下载xlrd</td><td align="left">pip install xlrd</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>筛选后自动排列序号</title>
      <link href="/d2a6daf0b923/"/>
      <url>/d2a6daf0b923/</url>
      
        <content type="html"><![CDATA[<p>&#x3D;subtotal(3，B$2:B2)*1<br>“3”为函数序号<br>“B$2:B2”为序号数值</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>筛选求和</title>
      <link href="/ec0a477c9754/"/>
      <url>/ec0a477c9754/</url>
      
        <content type="html"><![CDATA[<p>&#x3D;SUBTOTAL(9,C1:C10)<br>“9”为函数序号<br>“C1:C10”选择数值列</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>返回左边中文文本</title>
      <link href="/7d55381ee989/"/>
      <url>/7d55381ee989/</url>
      
        <content type="html"><![CDATA[<p>&#x3D;LEFTB(A1,SEARCHB(“?”,A1)-1)<br>“A1”为所选单元格</p>]]></content>
      
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
